arrange(Fis)
gg <- ggplot(data = ploid_tbl, aes(x = Name, y = Fis,fill = state))+
geom_bar(stat = 'identity') +
geom_hline(data = group_stats, aes(yintercept = mean,color="#00ff00")) +
#geom_hline(yintercept = group_stats$sd) +
theme(axis.text.x = element_blank()) + facet_wrap(~Family,drop=T, scale='free')
xlab("Individuals") + ylab("Inbreeding coefficient") + ggtitle(thresh)
gg
return(print(gg))
}
in_data %>%
mutate(state=paste0(Generation,Sex,Ploidy)) %>%
rename(Fis=F) %>%
ploidy_plot(.,basename(in_file))
ploidy_plot <- function(ploid_tbl,thresh){
group_stats <- ploid_tbl %>%
filter(Generation == 'F4' & Sex == 'F') %>%
group_by(Family) %>%
summarise_at(.cols=c("Fis"),.funs = c("mean","sd"))
ploid_tbl <- ploid_tbl %>%
group_by(Family) %>%
arrange(Fis)
gg <- ggplot(data = ploid_tbl, aes(x = Name, y = Fis,fill = state))+
geom_bar(stat = 'identity') +
geom_hline(data = group_stats, aes(yintercept = mean,color="#00ff00")) +
#geom_hline(yintercept = group_stats$sd) +
theme(axis.text.x = element_blank()) + facet_wrap(~Family,drop=T, scale='free') +
xlab("Individuals") + ylab("Inbreeding coefficient") + ggtitle(thresh)
gg
return(print(gg))
}
in_data %>%
mutate(state=paste0(Generation,Sex,Ploidy)) %>%
rename(Fis=F) %>%
ploidy_plot(.,basename(in_file))
ploidy_plot <- function(ploid_tbl,thresh){
group_stats <- ploid_tbl %>%
filter(Generation == 'F4' & Sex == 'F') %>%
group_by(Family) %>%
summarise_at(.cols=c("Fis"),.funs = c("mean","sd"))
gg <- ggplot(data = ploid_tbl, aes(x = Name[order(Fis)], y = Fis,fill = state))+
geom_bar(stat = 'identity') +
geom_hline(data = group_stats, aes(yintercept = mean,color="#00ff00")) +
#geom_hline(yintercept = group_stats$sd) +
theme(axis.text.x = element_blank()) + facet_wrap(~Family,drop=T, scale='free') +
xlab("Individuals") + ylab("Inbreeding coefficient") + ggtitle(thresh)
gg
return(print(gg))
}
in_data %>%
mutate(state=paste0(Generation,Sex,Ploidy)) %>%
rename(Fis=F) %>%
ploidy_plot(.,basename(in_file))
ploidy_plot <- function(ploid_tbl,thresh){
group_stats <- ploid_tbl %>%
filter(Generation == 'F4' & Sex == 'F') %>%
group_by(Family) %>%
summarise_at(.cols=c("Fis"),.funs = c("mean","sd"))
gg <- ggplot(data = ploid_tbl, aes(x = Name %>% group_by(Family) %>% arrange(Fis), y = Fis,fill = state))+
geom_bar(stat = 'identity') +
geom_hline(data = group_stats, aes(yintercept = mean,color="#00ff00")) +
#geom_hline(yintercept = group_stats$sd) +
theme(axis.text.x = element_blank()) + facet_wrap(~Family,drop=T, scale='free') +
xlab("Individuals") + ylab("Inbreeding coefficient") + ggtitle(thresh)
gg
return(print(gg))
}
in_data %>%
mutate(state=paste0(Generation,Sex,Ploidy)) %>%
rename(Fis=F) %>%
ploidy_plot(.,basename(in_file))
ploidy_plot <- function(ploid_tbl,thresh){
group_stats <- ploid_tbl %>%
filter(Generation == 'F4' & Sex == 'F') %>%
group_by(Family) %>%
summarise_at(.cols=c("Fis"),.funs = c("mean","sd"))
gg <- ggplot(data = ploid_tbl, aes(x = as.character(Fis[order(Fis)]), y = Fis,fill = state))+
geom_bar(stat = 'identity') +
geom_hline(data = group_stats, aes(yintercept = mean,color="#00ff00")) +
#geom_hline(yintercept = group_stats$sd) +
theme(axis.text.x = element_blank()) + facet_wrap(~Family,drop=T, scale='free') +
xlab("Individuals") + ylab("Inbreeding coefficient") + ggtitle(thresh)
gg
return(print(gg))
}
in_data %>%
mutate(state=paste0(Generation,Sex,Ploidy)) %>%
rename(Fis=F) %>%
ploidy_plot(.,basename(in_file))
ploidy_plot <- function(ploid_tbl,thresh){
group_stats <- ploid_tbl %>%
filter(Generation == 'F4' & Sex == 'F') %>%
group_by(Family) %>%
summarise_at(.cols=c("Fis"),.funs = c("mean","sd"))
gg <- ggplot(data = ploid_tbl, aes(x = factor(Fis), y = Fis,fill = state))+
geom_bar(stat = 'identity') +
geom_hline(data = group_stats, aes(yintercept = mean,color="#00ff00")) +
#geom_hline(yintercept = group_stats$sd) +
theme(axis.text.x = element_blank()) + facet_wrap(~Family,drop=T, scale='free') +
xlab("Individuals") + ylab("Inbreeding coefficient") + ggtitle(thresh)
gg
return(print(gg))
}
in_data %>%
mutate(state=paste0(Generation,Sex,Ploidy)) %>%
rename(Fis=F) %>%
ploidy_plot(.,basename(in_file))
ploidy_plot <- function(ploid_tbl,thresh){
group_stats <- ploid_tbl %>%
filter(Generation == 'F4' & Sex == 'F') %>%
group_by(Family) %>%
summarise_at(.cols=c("Fis"),.funs = c("mean","sd"))
gg <- ggplot(data = ploid_tbl, aes(x = factor(Fis), y = Fis,fill = state))+
geom_bar(stat = 'identity') +
geom_hline(data = group_stats, aes(yintercept = mean,color="#00ff00")) +
geom_segment(data = group_stats,aes(x=0,xend=0,y=mean-sd,yend=mean+sd))
theme(axis.text.x = element_blank()) + facet_wrap(~Family,drop=T, scale='free') +
xlab("Individuals") + ylab("Inbreeding coefficient") + ggtitle(thresh)
gg
return(print(gg))
}
in_data %>%
mutate(state=paste0(Generation,Sex,Ploidy)) %>%
rename(Fis=F) %>%
ploidy_plot(.,basename(in_file))
ploidy_plot <- function(ploid_tbl,thresh){
group_stats <- ploid_tbl %>%
filter(Generation == 'F4' & Sex == 'F') %>%
group_by(Family) %>%
summarise_at(.cols=c("Fis"),.funs = c("mean","sd"))
gg <- ggplot(data = ploid_tbl, aes(x = factor(Fis), y = Fis,fill = state))+
geom_bar(stat = 'identity') +
geom_hline(data = group_stats, aes(yintercept = mean,color="#00ff00")) +
geom_segment(data = group_stats,aes(x=0,xend=0,y=mean-sd,yend=mean+sd)) +
theme(axis.text.x = element_blank()) + facet_wrap(~Family,drop=T, scale='free') +
xlab("Individuals") + ylab("Inbreeding coefficient") + ggtitle(thresh)
gg
return(print(gg))
}
in_data %>%
mutate(state=paste0(Generation,Sex,Ploidy)) %>%
rename(Fis=F) %>%
ploidy_plot(.,basename(in_file))
in_data %>%
mutate(state=paste0(Generation,Sex,Ploidy)) %>%
rename(Fis=F) %>%
ploidy_plot(.,basename(in_file))
View(in_data)
ploidy_plot <- function(ploid_tbl,thresh){
print(ploid_tbl)
group_stats <- ploid_tbl %>%
filter(Generation == 'F4' & Sex == 'F') %>%
group_by(Family) %>%
summarise_at(.cols=c("Fis"),.funs = c("mean","sd"))
gg <- ggplot(data = ploid_tbl, aes(x = factor(Fis), y = Fis,fill = state))+
geom_bar(stat = 'identity') +
geom_hline(data = group_stats, aes(yintercept = mean,color="#00ff00")) +
geom_segment(data = group_stats,aes(x=0,xend=0,y=mean-sd,yend=mean+sd)) +
theme(axis.text.x = element_blank()) + facet_wrap(~Family,drop=T, scale='free') +
xlab("Individuals") + ylab("Inbreeding coefficient") + ggtitle(thresh)
gg
return(print(gg))
}
in_data %>%
mutate(state=paste0(Generation,Sex,Ploidy)) %>%
rename(Fis=F) %>%
ploidy_plot(.,basename(in_file))
ploidy_plot <- function(ploid_tbl,thresh){
print(ploid_tbl)
group_stats <- ploid_tbl %>%
filter(Generation == 'F4' & Sex == 'F') %>%
group_by(Family) %>%
summarise_at(.cols=c("Fis"),.funs = c("mean","sd"))
gg <- ggplot(data = ploid_tbl, aes(x = factor(Fis), y = Fis,fill = state))+
geom_bar(stat = 'identity') +
geom_hline(data = group_stats, aes(yintercept = mean,color="#00ff00")) +
geom_segment(data = group_stats,aes(x=0,xend=0,y=mean-sd,yend=mean+sd,color="#00ff00")) +
theme(axis.text.x = element_blank()) + facet_wrap(~Family,drop=T, scale='free') +
xlab("Individuals") + ylab("Inbreeding coefficient") + ggtitle(thresh)
gg
return(print(gg))
}
in_data %>%
mutate(state=paste0(Generation,Sex,Ploidy)) %>%
rename(Fis=F) %>%
ploidy_plot(.,basename(in_file))
ploidy_plot <- function(ploid_tbl,thresh){
print(ploid_tbl)
group_stats <- ploid_tbl %>%
filter(Generation == 'F4' & Sex == 'F') %>%
group_by(Family) %>%
summarise_at(.cols=c("Fis"),.funs = c("mean","sd")) %>%
mutate(state = F4FD)
gg <- ggplot(data = ploid_tbl, aes(x = factor(Fis), y = Fis,fill = state))+
geom_bar(stat = 'identity') +
geom_hline(data = group_stats, aes(yintercept = mean)) +
geom_segment(data = group_stats,aes(x=0,xend=0,y=mean-sd,yend=mean+sd,color="#00ff00")) +
theme(axis.text.x = element_blank()) + facet_wrap(~Family,drop=T, scale='free') +
xlab("Individuals") + ylab("Inbreeding coefficient") + ggtitle(thresh)
gg
return(print(gg))
}
in_data %>%
mutate(state=paste0(Generation,Sex,Ploidy)) %>%
rename(Fis=F) %>%
ploidy_plot(.,basename(in_file))
View(ploid_tbl)
View(in_data)
ploid_tbl = in_data
ploidy_plot <- function(ploid_tbl,thresh){
print(ploid_tbl)
group_stats <- ploid_tbl %>%
filter(Generation == 'F4' & Sex == 'F') %>%
group_by(Family) %>%
summarise_at(.cols=c("Fis"),.funs = c("mean","sd")) %>%
mutate(state = F4FD)
gg <- ggplot(data = ploid_tbl, aes(x = factor(Fis), y = Fis,fill = state))+
geom_bar(stat = 'identity') +
geom_hline(data = group_stats, aes(yintercept = mean)) +
geom_segment(data = group_stats,aes(x=0,xend=0,y=mean-sd,yend=mean+sd,color="#00ff00")) +
theme(axis.text.x = element_blank()) + facet_wrap(~Family,drop=T, scale='free') +
xlab("Individuals") + ylab("Inbreeding coefficient") + ggtitle(thresh)
gg
return(print(gg))
}
in_data %>%
mutate(state=paste0(Generation,Sex,Ploidy)) %>%
rename(Fis=F) %>%
ploidy_plot(.,basename(in_file))
View(ploid_tbl)
ploidy_plot <- function(ploid_tbl,thresh){
print(ploid_tbl)
group_stats <- ploid_tbl %>%
filter(Generation == 'F4' & Sex == 'F') %>%
group_by(Family) %>%
summarise_at(.cols=c("Fis"),.funs = c("mean","sd")) %>%
mutate(state = "F4FD")
gg <- ggplot(data = ploid_tbl, aes(x = factor(Fis), y = Fis,fill = state))+
geom_bar(stat = 'identity') +
geom_hline(data = group_stats, aes(yintercept = mean)) +
geom_segment(data = group_stats,aes(x=0,xend=0,y=mean-sd,yend=mean+sd,color="#00ff00")) +
theme(axis.text.x = element_blank()) + facet_wrap(~Family,drop=T, scale='free') +
xlab("Individuals") + ylab("Inbreeding coefficient") + ggtitle(thresh)
gg
return(print(gg))
}
in_data %>%
mutate(state=paste0(Generation,Sex,Ploidy)) %>%
rename(Fis=F) %>%
ploidy_plot(.,basename(in_file))
ploidy_plot <- function(ploid_tbl,thresh){
group_stats <- ploid_tbl %>%
filter(Generation == 'F4' & Sex == 'F') %>%
group_by(Family) %>%
summarise_at(.cols=c("Fis"),.funs = c("mean","sd")) %>%
mutate(state = "F4FD")
gg <- ggplot(data = ploid_tbl, aes(x = factor(Fis), y = Fis,fill = state))+
geom_bar(stat = 'identity') +
geom_hline(data = group_stats, aes(yintercept = mean)) +
geom_segment(data = group_stats,aes(x=length(levels(factor(Fis)))/2,xend=0,y=mean-sd,yend=mean+sd)) +
theme(axis.text.x = element_blank()) + facet_wrap(~Family,drop=T, scale='free') +
xlab("Individuals") + ylab("Inbreeding coefficient") + ggtitle(thresh)
gg
return(print(gg))
}
in_data %>%
mutate(state=paste0(Generation,Sex,Ploidy)) %>%
rename(Fis=F) %>%
ploidy_plot(.,basename(in_file))
ploidy_plot <- function(ploid_tbl,thresh){
group_stats <- ploid_tbl %>%
filter(Generation == 'F4' & Sex == 'F') %>%
group_by(Family) %>%
summarise_at(.cols=c("Fis"),.funs = c("mean","sd")) %>%
mutate(state = "F4FD")
gg <- ggplot(data = ploid_tbl, aes(x = factor(Fis), y = Fis,fill = state))+
geom_bar(stat = 'identity') +
geom_hline(data = group_stats, aes(yintercept = mean)) +
geom_segment(data = group_stats,aes(x=length(levels(factor(ploid_tbl$Fis)))/2,xend=0,y=mean-sd,yend=mean+sd)) +
theme(axis.text.x = element_blank()) + facet_wrap(~Family,drop=T, scale='free') +
xlab("Individuals") + ylab("Inbreeding coefficient") + ggtitle(thresh)
gg
return(print(gg))
}
in_data %>%
mutate(state=paste0(Generation,Sex,Ploidy)) %>%
rename(Fis=F) %>%
ploidy_plot(.,basename(in_file))
ploidy_plot <- function(ploid_tbl,thresh){
group_stats <- ploid_tbl %>%
filter(Generation == 'F4' & Sex == 'F') %>%
group_by(Family) %>%
summarise_at(.cols=c("Fis"),.funs = c("mean","sd")) %>%
mutate(state = "F4FD")
gg <- ggplot(data = ploid_tbl, aes(x = factor(Fis), y = Fis,fill = state))+
geom_bar(stat = 'identity') +
geom_hline(data = group_stats, aes(yintercept = mean)) +
geom_segment(data = group_stats,aes(x=length(levels(factor(ploid_tbl$Fis)))/2,xend=length(levels(factor(ploid_tbl$Fis)))/2,y=mean-sd,yend=mean+sd)) +
theme(axis.text.x = element_blank()) + facet_wrap(~Family,drop=T, scale='free') +
xlab("Individuals") + ylab("Inbreeding coefficient") + ggtitle(thresh)
gg
return(print(gg))
}
in_data %>%
mutate(state=paste0(Generation,Sex,Ploidy)) %>%
rename(Fis=F) %>%
ploidy_plot(.,basename(in_file))
ploidy_plot <- function(ploid_tbl,thresh){
group_stats <- ploid_tbl %>%
filter(Generation == 'F4' & Sex == 'F') %>%
group_by(Family) %>%
summarise_at(.cols=c("Fis"),.funs = c("mean","sd")) %>%
mutate(state = "F4FD") %>%
mutate(mid_x = n(.)/2)
gg <- ggplot(data = ploid_tbl, aes(x = factor(Fis), y = Fis,fill = state))+
geom_bar(stat = 'identity') +
geom_hline(data = group_stats, aes(yintercept = mean)) +
geom_segment(data = group_stats,aes(x=mid_x,xend=mid_x,y=mean-sd,yend=mean+sd)) +
theme(axis.text.x = element_blank()) + facet_wrap(~Family,drop=T, scale='free') +
xlab("Individuals") + ylab("Inbreeding coefficient") + ggtitle(thresh)
gg
return(print(gg))
}
in_data %>%
mutate(state=paste0(Generation,Sex,Ploidy)) %>%
rename(Fis=F) %>%
ploidy_plot(.,basename(in_file))
n()
ploidy_plot <- function(ploid_tbl,thresh){
group_stats <- ploid_tbl %>%
filter(Generation == 'F4' & Sex == 'F') %>%
group_by(Family) %>%
summarise_at(.cols=c("Fis"),.funs = c("mean","sd")) %>%
mutate(state = "F4FD") %>%
mutate(mid_x = n()/2)
gg <- ggplot(data = ploid_tbl, aes(x = factor(Fis), y = Fis,fill = state))+
geom_bar(stat = 'identity') +
geom_hline(data = group_stats, aes(yintercept = mean)) +
geom_segment(data = group_stats,aes(x=mid_x,xend=mid_x,y=mean-sd,yend=mean+sd)) +
theme(axis.text.x = element_blank()) + facet_wrap(~Family,drop=T, scale='free') +
xlab("Individuals") + ylab("Inbreeding coefficient") + ggtitle(thresh)
gg
return(print(gg))
}
in_data %>%
mutate(state=paste0(Generation,Sex,Ploidy)) %>%
rename(Fis=F) %>%
ploidy_plot(.,basename(in_file))
ploidy_plot <- function(ploid_tbl,thresh){
group_stats <- ploid_tbl %>%
filter(Generation == 'F4' & Sex == 'F') %>%
group_by(Family) %>%
summarise_at(.cols=c("Fis"),.funs = c("mean","sd")) %>%
mutate(state = "Daughters") %>%
mutate(mid_x = n()/2)
gg <- ggplot(data = ploid_tbl, aes(x = factor(Fis), y = Fis,fill = state))+
geom_bar(stat = 'identity') +
geom_hline(data = group_stats, aes(yintercept = mean)) +
geom_segment(data = group_stats,aes(x=mid_x,xend=mid_x,y=mean-sd,yend=mean+sd)) +
theme(axis.text.x = element_blank()) + facet_wrap(~Family,drop=T, scale='free') +
xlab("Individuals") + ylab("Inbreeding coefficient") + ggtitle(thresh)
#pdf(paste0('data/ploidy/plots/',thresh,'.pdf'))
gg
#dev.off()
}
in_data %>%
mutate(state=paste0(Generation,Sex,Ploidy)) %>%
rename(Fis=F) %>%
mutate(state = fct_recode(state, "F3FD" = "Mothers",
"F4FD" = "Daughters",
"F4MH" = "1N Sons",
"F4MD" = "2N Sons")) %>%
ploidy_plot(.,basename(in_file))
library(tidyverse)
in_data %>%
mutate(state=paste0(Generation,Sex,Ploidy)) %>%
rename(Fis=F) %>%
recode(state, "F3FD" = "Mothers",
"F4FD" = "Daughters",
"F4MH" = "1N Sons",
"F4MD" = "2N Sons") %>%
ploidy_plot(.,basename(in_file))
in_data %>%
mutate(state=paste0(Generation,Sex,Ploidy)) %>%
rename(Fis=F) %>%
recode_factor(state, "F3FD" = "Mothers",
"F4FD" = "Daughters",
"F4MH" = "1N Sons",
"F4MD" = "2N Sons") %>%
ploidy_plot(.,basename(in_file))
in_data %>%
mutate(state=paste0(Generation,Sex,Ploidy)) %>%
rename(Fis=F) %>%
recode_factor(state, "F3FD" = "Mothers",
"F4FD" = "Daughters",
"F4MH" = "1N Sons",
"F4MD" = "2N Sons")
in_data %>%
mutate(state=as.factor(paste0(Generation,Sex,Ploidy))) %>%
rename(Fis=F) %>%
recode_factor(state, "F3FD" = "Mothers",
"F4FD" = "Daughters",
"F4MH" = "1N Sons",
"F4MD" = "2N Sons") %>%
ploidy_plot(.,basename(in_file))
in_data %>%
mutate(state=as.factor(paste0(Generation,Sex,Ploidy))) %>%
rename(Fis=F) %>%
recode_factor(.,state, "F3FD" = "Mothers",
"F4FD" = "Daughters",
"F4MH" = "1N Sons",
"F4MD" = "2N Sons") %>%
ploidy_plot(.,basename(in_file))
in_data %>%
mutate(state=paste0(Generation,Sex,Ploidy)) %>%
rename(Fis=F) %>%
recode_factor(state, c("F3FD" = "Mothers",
"F4FD" = "Daughters",
"F4MH" = "1N Sons",
"F4MD" = "2N Sons")) %>%
)
in_data %>%
mutate(state=paste0(Generation,Sex,Ploidy)) %>%
rename(Fis=F) %>%
recode_factor(state, c("F3FD" = "Mothers",
"F4FD" = "Daughters",
"F4MH" = "1N Sons",
"F4MD" = "2N Sons"))
in_data %<>%
mutate(state=paste0(Generation,Sex,Ploidy)) %>%
rename(Fis=F)
in_data
recode_factor(in_data$state, "F3FD" = "Mothers",
"F4FD" = "Daughters",
"F4MH" = "1N Sons",
"F4MD" = "2N Sons")
in_data$state <-recode_factor(in_data$state, "F3FD" = "Mothers",
"F4FD" = "Daughters",
"F4MH" = "1N Sons",
"F4MD" = "2N Sons")
ploidy_plot(.,basename(in_file))
ploidy_plot(in_data,basename(in_file))
ploidy_plot(in_data,basename(in_file))
in_folder <- '../../data/ploidy/'
haplo_prop <- tibble(threshold = numeric(0),
Daughters = numeric(0),
Mothers = numeric(0)
)
library(tidyverse)
haplo_prop <- tibble(threshold = numeric(0),
Daughters = numeric(0),
Mothers = numeric(0)
)
group_stats <- ploid_tbl %>%  # Computing summary stats for each family
filter(Generation == 'F4' & Sex == 'F') %>%  # Computing from daughters only
group_by(Family) %>%
summarise_at(.cols=c("Fis"),.funs = c("mean","sd")) %>%
mutate(state = "Daughters") %>%  # These are all daughters (used for plotting)
mutate(mid_x = n()/2)  # Graphical parameter for plots
# Producing barplot faceted by family, with mean and standard deviation displayed
# as segments. Colors represent individuals' states.
gg <- ggplot(data = ploid_tbl, aes(x = factor(Fis), y = Fis,fill = state))+
geom_bar(stat = 'identity') +
geom_hline(data = group_stats, aes(yintercept = mean)) +
geom_segment(data = group_stats,aes(x=mid_x,xend=mid_x,y=mean-sd,yend=mean+sd)) +
theme(axis.text.x = element_blank()) + facet_wrap(~Family,drop=T, scale='free') +
xlab("Individuals") + ylab("Inbreeding coefficient") + ggtitle(thresh)
pdf(paste0('data/ploidy/plots/',thresh,'.pdf'))  # Opening pdf connection
print(gg)  # Saving plot
dev.off()  # Closing connection
}
ploidy_plot <- function(ploid_tbl,thresh){
group_stats <- ploid_tbl %>%  # Computing summary stats for each family
filter(Generation == 'F4' & Sex == 'F') %>%  # Computing from daughters only
group_by(Family) %>%
summarise_at(.cols=c("Fis"),.funs = c("mean","sd")) %>%
mutate(state = "Daughters") %>%  # These are all daughters (used for plotting)
mutate(mid_x = n()/2)  # Graphical parameter for plots
# Producing barplot faceted by family, with mean and standard deviation displayed
# as segments. Colors represent individuals' states.
gg <- ggplot(data = ploid_tbl, aes(x = factor(Fis), y = Fis,fill = state))+
geom_bar(stat = 'identity') +
geom_hline(data = group_stats, aes(yintercept = mean)) +
geom_segment(data = group_stats,aes(x=mid_x,xend=mid_x,y=mean-sd,yend=mean+sd)) +
theme(axis.text.x = element_blank()) + facet_wrap(~Family,drop=T, scale='free') +
xlab("Individuals") + ylab("Inbreeding coefficient") + ggtitle(thresh)
pdf(paste0('data/ploidy/plots/',thresh,'.pdf'))  # Opening pdf connection
print(gg)  # Saving plot
dev.off()  # Closing connection
}
for(in_file in list.files(in_folder)){  # Iterating over input lists
in_data <- read_tsv(paste0(in_folder,in_file),col_names = T)  # Reading files sequentially
# Preparing data:
in_data %<>%   # Erasing original variable
mutate(state=paste0(Generation,Sex,Ploidy)) %>%  # New column containing state information
rename(Fis=F)  # Renaming inbreeding coefficient column (F is colliding with 'FALSE')
# Changing individual states by Human-friendly names
in_data$state <-recode_factor(in_data$state, "F3FD" = "Mothers",  #
"F4FD" = "Daughters",
"F4MH" = "1N Sons",
"F4MD" = "2N Sons")
ploidy_plot(in_data,basename(in_file))  # Calling plotting function
}
list.files(in_folder)
in_file <- 'm1'
in_data %<>%   # Erasing original variable
mutate(state=paste0(Generation,Sex,Ploidy)) %>%  # New column containing state information
rename(Fis=F)  # Renaming inbreeding coefficient column (F is colliding with 'FALSE')
# Changing individual states by Human-friendly names
in_data <- read_tsv(paste0(in_folder,in_file),col_names = T)  # Reading files sequentially
in_data <- read_tsv(paste0(in_folder,in_file),col_names = T)  # Reading files sequentially
View(in_data)
