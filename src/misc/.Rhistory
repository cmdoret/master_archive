setting par(xpd=NA)$xpd
setting par()$xpd
setting
par()$xpd
par(xpd)
$xpd
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
col2rgb('pink')
192/255
203/255
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
parent.frame(2)
parent.frame(2)$ofile
dirname(parent.frame(2)$ofile)
parent.frame(2)
parent.frame(2)[1]
parent.frame(2)[1,]
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
sys.frame(1)
sys.frame(1)$ofile
dirname(sys.frame(1)$ofile)
library(R.utils)
findSourceTraceback()
sourceDir <- getSrcDirectory(function(dummy) {dummy})
setwd(sourceDir)
getSrcDirectory(function(x) {x})
args = commandArgs(trailingOnly=TRUE)
args
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
View(ref_table)
sex_palette <- c('pink','blue')  # Color palette used to represent sex
for(p in param_space){
sex_palette <- c('pink','blue')  # Color palette used to represent sex
sum_table <- read.table(file=paste0("vcftools/summary_r-",p),sep='\t',header=T)  # reading input file
sum_table$SEX <- sapply(sum_table$INDV,function(x) substr(x,8,8))  # Extracting sex info from sample name
sum_table$FAMILY <- sapply(sum_table$INDV,function(x) substr(x,4,4))  # Extracting family info from sample name
sum_table$INDV <- sapply(sum_table$INDV,function(x) substr(x,4,6))  # Shortening sample name
sum_table$PROP <- sum_table$O.HOM./ sum_table$E.HOM.
corr <- format(cor.test(x = sum_table[,stat1],y = sum_table[,stat2],method = 'pearson')$estimate,digits = 2)
pv <- format(cor.test(x = sum_table[,stat1],y = sum_table[,stat2],method = 'pearson')$p.value,digits = 2)
plot(x = sum_table[,stat1],y = sum_table[,stat2],xlab='mean depth',ylab='F(IS)',
col =  sex_palette[as.factor(sum_table$SEX)],main=paste0(f,': cor= ',corr,'; p=',pv))
}
for(p in param_space){
sex_palette <- c('pink','blue')  # Color palette used to represent sex
sum_table <- read.table(file=paste0("vcftools/summary_r-",p),sep='\t',header=T)  # reading input file
sum_table$SEX <- sapply(sum_table$INDV,function(x) substr(x,8,8))  # Extracting sex info from sample name
sum_table$FAMILY <- sapply(sum_table$INDV,function(x) substr(x,4,4))  # Extracting family info from sample name
sum_table$INDV <- sapply(sum_table$INDV,function(x) substr(x,4,6))  # Shortening sample name
sum_table$PROP <- sum_table$O.HOM./ sum_table$E.HOM.
corr <- format(cor.test(x = sum_table[,'MEAN_DEPTH'],y = sum_table[,'F'],method = 'pearson')$estimate,digits = 2)
pv <- format(cor.test(x = sum_table[,'MEAN_DEPTH'],y = sum_table[,'F'],method = 'pearson')$p.value,digits = 2)
plot(x = sum_table[,'MEAN_DEPTH'],y = sum_table[,'F'],xlab='mean depth',ylab='F(IS)',
col =  sex_palette[as.factor(sum_table$SEX)],main=paste0(f,': cor= ',corr,'; p=',pv))
}
for(p in param_space){
sex_palette <- c('pink','blue')  # Color palette used to represent sex
sum_table <- read.table(file=paste0("vcftools/summary_r-",p),sep='\t',header=T)  # reading input file
sum_table$SEX <- sapply(sum_table$INDV,function(x) substr(x,8,8))  # Extracting sex info from sample name
sum_table$FAMILY <- sapply(sum_table$INDV,function(x) substr(x,4,4))  # Extracting family info from sample name
sum_table$INDV <- sapply(sum_table$INDV,function(x) substr(x,4,6))  # Shortening sample name
sum_table$PROP <- sum_table$O.HOM./ sum_table$E.HOM.
corr <- format(cor.test(x = sum_table[,'MEAN_DEPTH'],y = sum_table[,'F'],method = 'pearson')$estimate,digits = 2)
pv <- format(cor.test(x = sum_table[,'MEAN_DEPTH'],y = sum_table[,'F'],method = 'pearson')$p.value,digits = 2)
plot(x = sum_table[,'MEAN_DEPTH'],y = sum_table[,'F'],xlab='mean depth',ylab='F(IS)',
col =  sex_palette[as.factor(sum_table$SEX)],main=paste0(': cor= ',corr,'; p=',pv))
}
plot(x = sum_table[,'MEAN_DEPTH'],y = sum_table[,'F'],xlab='mean depth',ylab='F(IS)',
col =  sex_palette[as.factor(sum_table$SEX)],main=paste0(': cor= ',corr,'; p=',pv))
dev.off()
plot(x = sum_table[,'MEAN_DEPTH'],y = sum_table[,'F'],xlab='mean depth',ylab='F(IS)',
col =  sex_palette[as.factor(sum_table$SEX)],main=paste0(': cor= ',corr,'; p=',pv))
dev.off()
dev.off()
sex_palette <- c('pink','blue')  # Color palette used to represent sex
sum_table <- read.table(file=paste0("vcftools/summary_r-",p),sep='\t',header=T)  # reading input file
sum_table$SEX <- sapply(sum_table$INDV,function(x) substr(x,8,8))  # Extracting sex info from sample name
sum_table$FAMILY <- sapply(sum_table$INDV,function(x) substr(x,4,4))  # Extracting family info from sample name
sum_table$INDV <- sapply(sum_table$INDV,function(x) substr(x,4,6))  # Shortening sample name
sum_table$PROP <- sum_table$O.HOM./ sum_table$E.HOM.
corr <- format(cor.test(x = sum_table[,'MEAN_DEPTH'],y = sum_table[,'F'],method = 'pearson')$estimate,digits = 2)
pv <- format(cor.test(x = sum_table[,'MEAN_DEPTH'],y = sum_table[,'F'],method = 'pearson')$p.value,digits = 2)
plot(x = sum_table[,'MEAN_DEPTH'],y = sum_table[,'F'],xlab='mean depth',ylab='F(IS)',
col =  sex_palette[as.factor(sum_table$SEX)],main=paste0(': cor= ',corr,'; p=',pv))
sum_table[,'MEAN_DEPTH']
plot(x = sum_table[,'MEAN_DEPTH'],y = sum_table[,'F'])
colnames(sum_table)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
source('~/Documents/Master/master_project/src/misc/plot_VCF.R', echo=TRUE)
for(p in param_space){
#'for(p in param_space){
pdf(paste0("vcftools/","full_corr_r-",p,".pdf"),width = 9)
#' for(p in param_space){
