library(dplyr)
in_path <- commandArgs(TrailingOnly=T)[1]
phi_stat <- read.csv('../../data/populations/r-75/batch_0.phistats_F-M.tsv',header=T,skip=2,sep='\t')
phi_stat <- tbl(phi_stat)
by_chrom <- phi_stat %>% group_by(Chr) %>% summarise(avg=mean(Smoothed.Fst.)
plot(by_chrom,type='p')
library(dplyr)
in_path <- commandArgs(TrailingOnly=T)[1]
phi_stat <- read.csv('../../data/populations/d-25r-75/batch_0.phistats_F-M.tsv',header=T,skip=2,sep='\t')
phi_stat <- read.csv('../../data/populations/d-25_r-75/batch_0.phistats_F-M.tsv',header=T,skip=2,sep='\t')
phi_stat <- tbl(phi_stat)
by_chrom <- phi_stat %>% group_by(Chr) %>% summarise(avg=mean(Smoothed.Fst.))
plot(by_chrom,type='p')
phi_stat
phi_stat <- tbl(phi_stat)
phi_stat <- read_csv('../../data/populations/d-25_r-75/batch_0.phistats_F-M.tsv',header=T,skip=2,sep='\t')
phi_stat <- read.csv('../../data/populations/d-25_r-75/batch_0.phistats_F-M.tsv',header=T,skip=2,sep='\t')
phi_stat <- tbl(phi_stat)
View(phi_stat)
View(phi_stat)
View(phi_stat)
by_chrom <- phi_stat %>% group_by(Chr) %>% summarise(avg=mean(Fst.))
plot(by_chrom,type='p')
View(by_chrom)
View(phi_stat)
library(tidyverse)
ref_path <- '../../data/ref_genome/canu2_low_corrRE.contigs.fasta'
paste('cat', ref_path, '| grep ">" > src/misc/ref_contigs.txt',sep=' ')
system(paste('cat', ref_path, '| grep ">" > src/misc/ref_contigs.txt',sep=' '))
system(paste('cat', ref_path, '| grep ">" > ../../src/misc/ref_contigs.txt',sep=' '))
system(paste('cat', ref_path, '| grep ">" >', summary_path,sep=' '))
summary_path <- "../../src/misc/ref_contigs.txt"
system(paste('cat', ref_path, '| grep ">" >', summary_path,sep=' '))
ref <- read_delim(file = summary_path, delim = ' ')
View(ref)
ref <- read_delim(file = summary_path, delim = ' ', col_names = F)
View(ref)
ref_num <- tibble(ID=rep(NA,nrow(ref)),len=rep(NA,nrow(ref))
ref_num <- tibble(ID=rep(NA,nrow(ref)),len=rep(NA,nrow(ref)))
ref_num <- tibble(ID=rep(NA,nrow(ref)),len=rep(NA,nrow(ref)))
ref_num
ref_num <- tibble(ID=ref[,1]),len=rep(NA,nrow(ref)))
ref_num <- tibble(ID=ref[,1],len=rep(NA,nrow(ref)))
ref_num <- tibble(ID=ref[,1],len=rep(NA,nrow(ref)))
ref[,1]
ref_num <- tibble(ID=ref[,1],len=rep(0,nrow(ref)))
ref_num <- tibble(contig=ref[,1],len=rep(0,nrow(ref)))
ref_num <- tibble(contig=ref[,1],len=rep(0,nrow(ref)))
ref[,1]
ref_num <- tibble(contig=as.vector(ref[,1]),len=rep(0,nrow(ref)))
as.vector(ref[,1])
colnames(ref) <- c("contig","len")
View(ref)
ref <- read_delim(file = summary_path, delim = ' ', col_names = F)[,1:2]
View(ref)
colnames(ref) <- c("contig","len")
View(ref)
ref$contig %>% gsub("len=([0-9]*)", replacement = "\1")
ref$contig %>% gsub(pattern = "len=([0-9]*)", replacement = "\1")
ref$len %>% gsub(pattern = "len=([0-9]*)", replacement = "\1")
ref$len %>% gsub(pattern = "len=\([0-9]*\)", replacement = "\1")
ref$len %>% gsub(pattern = "len=([0-9]*)", replacement = "\1")
ref$len %>% gsub(pattern = "len=([0-9]*)", replacement = "\\1")
ref$len %>%
gsub(pattern = "len=([0-9]*)", replacement = "\\1") %>%
as.numeric(.)
ref$len %<>%
gsub(pattern = "len=([0-9]*)", replacement = "\\1") %>%
as.numeric(.)
ref
mean(ref$len)
fivenum(ref$len)
sum(ref$len)
n50 <- ref %>% arrange(len)
n
n50
View(n50)
n50 <- ref %>% arrange(desc(len))
half_genome <- sum(ref$len)/2
half_genome
n50 <- ref %>% arrange(desc(len))
half_genome <- sum(ref$len)/2
half_genome <- sum(ref$len)/2
ord_contigs <- ref %>% arrange(desc(len))
iter_N50 <- 0
for(row in ord_contigs){
iter_N50 <- iter_N50 + row$len
if(iter_N50>=half_genome){
n50=row$len
break
}
}
row[2]
row[1]
half_genome <- sum(ref$len)/2
ord_contigs <- ref %>% arrange(desc(len))
iter_N50 <- 0
for(n in 1:nrow(ord_contigs)){
row <- ord_contigs[n,]
iter_N50 <- iter_N50 + row$len
if(iter_N50>=half_genome){
n50=row$len
break
}
}
n50
View(ord_contigs)
sum(ord_contigs$len[1:158])
half_genome
sum(ref$len)/1000000
round(sum(ref$len)/1000000, 1)
max(ref$len)
round(max(ref$len)/1000),1)
round(max(ref$len)/1000,1)
round(mean(ref$len)/1000, 1)
round(n50/1000, 1)
