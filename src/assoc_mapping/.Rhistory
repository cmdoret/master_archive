library(dplyr)
in_path <- commandArgs(TrailingOnly=T)[1]
phi_stat <- read.csv('../../data/populations/r-75/batch_0.phistats_F-M.tsv',header=T,skip=2,sep='\t')
phi_stat <- tbl(phi_stat)
by_chrom <- phi_stat %>% group_by(Chr) %>% summarise(avg=mean(Smoothed.Fst.)
plot(by_chrom,type='p')
library(dplyr)
in_path <- commandArgs(TrailingOnly=T)[1]
phi_stat <- read.csv('../../data/populations/d-25r-75/batch_0.phistats_F-M.tsv',header=T,skip=2,sep='\t')
phi_stat <- read.csv('../../data/populations/d-25_r-75/batch_0.phistats_F-M.tsv',header=T,skip=2,sep='\t')
phi_stat <- tbl(phi_stat)
by_chrom <- phi_stat %>% group_by(Chr) %>% summarise(avg=mean(Smoothed.Fst.))
plot(by_chrom,type='p')
phi_stat
phi_stat <- tbl(phi_stat)
phi_stat <- read_csv('../../data/populations/d-25_r-75/batch_0.phistats_F-M.tsv',header=T,skip=2,sep='\t')
phi_stat <- read.csv('../../data/populations/d-25_r-75/batch_0.phistats_F-M.tsv',header=T,skip=2,sep='\t')
phi_stat <- tbl(phi_stat)
View(phi_stat)
View(phi_stat)
View(phi_stat)
by_chrom <- phi_stat %>% group_by(Chr) %>% summarise(avg=mean(Fst.))
plot(by_chrom,type='p')
View(by_chrom)
View(phi_stat)
library(tidyverse)
ref_path <- '../../data/ref_genome/canu2_low_corrRE.contigs.fasta'
paste('cat', ref_path, '| grep ">" > src/misc/ref_contigs.txt',sep=' ')
system(paste('cat', ref_path, '| grep ">" > src/misc/ref_contigs.txt',sep=' '))
system(paste('cat', ref_path, '| grep ">" > ../../src/misc/ref_contigs.txt',sep=' '))
system(paste('cat', ref_path, '| grep ">" >', summary_path,sep=' '))
summary_path <- "../../src/misc/ref_contigs.txt"
system(paste('cat', ref_path, '| grep ">" >', summary_path,sep=' '))
ref <- read_delim(file = summary_path, delim = ' ')
View(ref)
ref <- read_delim(file = summary_path, delim = ' ', col_names = F)
View(ref)
ref_num <- tibble(ID=rep(NA,nrow(ref)),len=rep(NA,nrow(ref))
ref_num <- tibble(ID=rep(NA,nrow(ref)),len=rep(NA,nrow(ref)))
ref_num <- tibble(ID=rep(NA,nrow(ref)),len=rep(NA,nrow(ref)))
ref_num
ref_num <- tibble(ID=ref[,1]),len=rep(NA,nrow(ref)))
ref_num <- tibble(ID=ref[,1],len=rep(NA,nrow(ref)))
ref_num <- tibble(ID=ref[,1],len=rep(NA,nrow(ref)))
ref[,1]
ref_num <- tibble(ID=ref[,1],len=rep(0,nrow(ref)))
ref_num <- tibble(contig=ref[,1],len=rep(0,nrow(ref)))
ref_num <- tibble(contig=ref[,1],len=rep(0,nrow(ref)))
ref[,1]
ref_num <- tibble(contig=as.vector(ref[,1]),len=rep(0,nrow(ref)))
as.vector(ref[,1])
colnames(ref) <- c("contig","len")
View(ref)
ref <- read_delim(file = summary_path, delim = ' ', col_names = F)[,1:2]
View(ref)
colnames(ref) <- c("contig","len")
View(ref)
ref$contig %>% gsub("len=([0-9]*)", replacement = "\1")
ref$contig %>% gsub(pattern = "len=([0-9]*)", replacement = "\1")
ref$len %>% gsub(pattern = "len=([0-9]*)", replacement = "\1")
ref$len %>% gsub(pattern = "len=\([0-9]*\)", replacement = "\1")
ref$len %>% gsub(pattern = "len=([0-9]*)", replacement = "\1")
ref$len %>% gsub(pattern = "len=([0-9]*)", replacement = "\\1")
ref$len %>%
gsub(pattern = "len=([0-9]*)", replacement = "\\1") %>%
as.numeric(.)
ref$len %<>%
gsub(pattern = "len=([0-9]*)", replacement = "\\1") %>%
as.numeric(.)
ref
mean(ref$len)
fivenum(ref$len)
sum(ref$len)
n50 <- ref %>% arrange(len)
n
n50
View(n50)
n50 <- ref %>% arrange(desc(len))
half_genome <- sum(ref$len)/2
half_genome
n50 <- ref %>% arrange(desc(len))
half_genome <- sum(ref$len)/2
half_genome <- sum(ref$len)/2
ord_contigs <- ref %>% arrange(desc(len))
iter_N50 <- 0
for(row in ord_contigs){
iter_N50 <- iter_N50 + row$len
if(iter_N50>=half_genome){
n50=row$len
break
}
}
row[2]
row[1]
half_genome <- sum(ref$len)/2
ord_contigs <- ref %>% arrange(desc(len))
iter_N50 <- 0
for(n in 1:nrow(ord_contigs)){
row <- ord_contigs[n,]
iter_N50 <- iter_N50 + row$len
if(iter_N50>=half_genome){
n50=row$len
break
}
}
n50
View(ord_contigs)
sum(ord_contigs$len[1:158])
half_genome
sum(ref$len)/1000000
round(sum(ref$len)/1000000, 1)
max(ref$len)
round(max(ref$len)/1000),1)
round(max(ref$len)/1000,1)
round(mean(ref$len)/1000, 1)
round(n50/1000, 1)
library(dplyr)
phi_stat <- read.csv('../../data/populations/d-20_r-75/A/batch_0.phistats_F-M.tsv',header=T,skip=2,sep='\t')
phi_stat <- tbl(phi_stat)
library(dplyr)
phi_stat <- tbl(phi_stat)
phi_stat <- read_csv(phi_stat)
library(readr)
phi_stat <- read_csv(phi_stat)
phi_stat <- read.csv('../../data/populations/d-20_r-75/A/batch_0.phistats_F-M.tsv',header=T,skip=2,sep='\t')
View(phi_stat)
phi_stat <- tbl(phi_stat)
phi_stat <- read_csv('../../data/populations/d-20_r-75/A/batch_0.phistats_F-M.tsv',header=T,skip=2,sep='\t')
by_chrom <- phi_stat %>% group_by(Chr) %>% summarise(avg=mean(Fst.))
by_chrom
plot(by_chrom,type='p')
View(by_chrom)
View(phi_stat)
View(phi_stat)
View(phi_stat)
chrom <- phi_stat[1:313,]
chrom
View(chrom)
plot(chrom$Chr, chrom$Fst.)
chrom$pos = paste0(chrom$Chr,chrom$BP)
chrom
chrom$pos = paste(chrom$Chr,chrom$BP, sep="_")
chrom
plot(chrom$pos, chrom$Fst.)
chrom$pos
plot(rownames(chrom), chrom$Fst.)
plot(rownames(chrom), chrom$Fst., type=l)
plot(rownames(chrom), chrom$Fst., type="l")
filter(chrom,max(Fst.))
filter(chrom,max(Chrom$Fst.))
filter(chrom,max(chrom$Fst.))
max(chrom$Fst.)
chrom[chrom$Fst.==max(chrom$Fst.),]
highFST <- chrom[chrom$Fst.==max(chrom$Fst.),]
rownames(highFST)
text(x = as.numeric(rownames(highFST)),y = highFST$Fst.,labels = highFST$pos)
chrom[Chr=="chr1"]
chrom[chrom$Chr=="chr1"]
chrom[chrom$Chr=="chr1",]
chrom[chrom$Chr=="chr2",]
for(i in levels(chrom$Chr)){
tmp_chrom <- chrom[chrom$Chr==i,]
abline(v=as.numeric(min(rownames(tmp_chrom))))
}
View(chrom)
for(i in levels(chrom$Chr)){
tmp_chrom <- chrom[chrom$Chr==i,]
abline(v=as.numeric(min(rownames(tmp_chrom))), col='blue')
}
chrom <- phi_stat[grep("chr.*", phi_stat$Chr),]
chrom
View(chrom)
phi_stat <- read.csv('../../data/populations/d-20_r-75/A/batch_0.phistats_F-M.tsv',header=T,skip=2,sep='\t')
by_chrom <- phi_stat %>% group_by(Chr) %>% summarise(avg=mean(Fst.))
plot(by_chrom,type='p')
chrom <- phi_stat[grep("chr.*", phi_stat$Chr),]
chrom$pos = paste(chrom$Chr,chrom$BP, sep="_")
plot(rownames(chrom), chrom$Fst., type="l")
highFST <- chrom[chrom$Fst.==max(chrom$Fst.),]
text(x = as.numeric(rownames(highFST)),y = highFST$Fst.,labels = highFST$pos)
for(i in levels(chrom$Chr)){
tmp_chrom <- chrom[chrom$Chr==i,]
abline(v=as.numeric(min(rownames(tmp_chrom))), col='blue')
}
warnings()
phi_stat <- read.csv('../../data/populations/d-20_r-75/A/batch_0.phistats_F-M.tsv',header=T,skip=2,sep='\t')
by_chrom <- phi_stat %>% group_by(Chr) %>% summarise(avg=mean(Fst.))
plot(by_chrom,type='p')
chrom <- phi_stat[grep("chr.*", phi_stat$Chr),]
chrom$pos = paste(chrom$Chr,chrom$BP, sep="_")
plot(rownames(chrom), chrom$Fst., type="l")
highFST <- chrom[chrom$Fst.==max(chrom$Fst.),]
text(x = as.numeric(rownames(highFST)),y = highFST$Fst.,labels = highFST$pos)
for(i in levels(chrom$Chr)){
tmp_chrom <- chrom[chrom$Chr==i,]
abline(v=min(as.numeric(rownames(tmp_chrom))), col='blue')
}
warnigns()
warnings()
as.numeric(rownames(tmp_chrom))
rownames(tmp_chrom)
tmp_chrom
i
chrom
chrom$Chr=droplevels(chrom$Chr)
phi_stat <- read.csv('../../data/populations/d-20_r-75/A/batch_0.phistats_F-M.tsv',header=T,skip=2,sep='\t')
by_chrom <- phi_stat %>% group_by(Chr) %>% summarise(avg=mean(Fst.))
plot(by_chrom,type='p')
chrom <- phi_stat[grep("chr.*", phi_stat$Chr),]
chrom$pos = paste(chrom$Chr,chrom$BP, sep="_")
plot(rownames(chrom), chrom$Fst., type="l")
highFST <- chrom[chrom$Fst.==max(chrom$Fst.),]
text(x = as.numeric(rownames(highFST)),y = highFST$Fst.,labels = highFST$pos)
chrom$Chr=droplevels(chrom$Chr)
for(i in levels(chrom$Chr)){
tmp_chrom <- chrom[chrom$Chr==i,]
abline(v=min(as.numeric(rownames(tmp_chrom))), col='blue')
}
phi_stat <- read.csv('../../data/populations/d-20_r-75/B/batch_0.phistats_F-M.tsv',header=T,skip=2,sep='\t')
by_chrom <- phi_stat %>% group_by(Chr) %>% summarise(avg=mean(Fst.))
plot(by_chrom,type='p')
chrom <- phi_stat[grep("chr.*", phi_stat$Chr),]
chrom$pos = paste(chrom$Chr,chrom$BP, sep="_")
plot(rownames(chrom), chrom$Fst., type="l")
highFST <- chrom[chrom$Fst.==max(chrom$Fst.),]
text(x = as.numeric(rownames(highFST)),y = highFST$Fst.,labels = highFST$pos)
chrom$Chr=droplevels(chrom$Chr)
for(i in levels(chrom$Chr)){
tmp_chrom <- chrom[chrom$Chr==i,]
abline(v=min(as.numeric(rownames(tmp_chrom))), col='blue')
}
phi_stat <- read.csv('../../data/populations/d-20_r-75/C/batch_0.phistats_F-M.tsv',header=T,skip=2,sep='\t')
by_chrom <- phi_stat %>% group_by(Chr) %>% summarise(avg=mean(Fst.))
plot(by_chrom,type='p')
chrom <- phi_stat[grep("chr.*", phi_stat$Chr),]
chrom$pos = paste(chrom$Chr,chrom$BP, sep="_")
plot(rownames(chrom), chrom$Fst., type="l")
highFST <- chrom[chrom$Fst.==max(chrom$Fst.),]
text(x = as.numeric(rownames(highFST)),y = highFST$Fst.,labels = highFST$pos)
chrom$Chr=droplevels(chrom$Chr)
for(i in levels(chrom$Chr)){
tmp_chrom <- chrom[chrom$Chr==i,]
abline(v=min(as.numeric(rownames(tmp_chrom))), col='blue')
}
phi_stat <- read.csv('../../data/populations/d-20_r-75/C/batch_0.phistats_F-M.tsv',header=T,skip=2,sep='\t')
by_chrom <- phi_stat %>% group_by(Chr) %>% summarise(avg=mean(Fst.))
plot(by_chrom,type='p')
chrom <- phi_stat[grep("chr.*", phi_stat$Chr),]
chrom$pos = paste(chrom$Chr,chrom$BP, sep="_")
plot(rownames(chrom), chrom$Fst., type="l")
highFST <- chrom[chrom$Fst.==max(chrom$Fst.),]
text(x = as.numeric(rownames(highFST)),y = highFST$Fst.,labels = highFST$pos)
chrom$Chr=droplevels(chrom$Chr)
for(i in levels(chrom$Chr)){
tmp_chrom <- chrom[chrom$Chr==i,]
abline(v=min(as.numeric(rownames(tmp_chrom))), col='blue')
}
phi_stat <- read.csv('../../data/populations/d-20_r-75/D/batch_0.phistats_F-M.tsv',header=T,skip=2,sep='\t')
by_chrom <- phi_stat %>% group_by(Chr) %>% summarise(avg=mean(Fst.))
plot(by_chrom,type='p')
chrom <- phi_stat[grep("chr.*", phi_stat$Chr),]
chrom$pos = paste(chrom$Chr,chrom$BP, sep="_")
plot(rownames(chrom), chrom$Fst., type="l")
highFST <- chrom[chrom$Fst.==max(chrom$Fst.),]
text(x = as.numeric(rownames(highFST)),y = highFST$Fst.,labels = highFST$pos)
chrom$Chr=droplevels(chrom$Chr)
for(i in levels(chrom$Chr)){
tmp_chrom <- chrom[chrom$Chr==i,]
abline(v=min(as.numeric(rownames(tmp_chrom))), col='blue')
}
phi_stat <- read.csv('../../data/populations/d-20_r-75/E/batch_0.phistats_F-M.tsv',header=T,skip=2,sep='\t')
by_chrom <- phi_stat %>% group_by(Chr) %>% summarise(avg=mean(Fst.))
plot(by_chrom,type='p')
chrom <- phi_stat[grep("chr.*", phi_stat$Chr),]
chrom$pos = paste(chrom$Chr,chrom$BP, sep="_")
plot(rownames(chrom), chrom$Fst., type="l")
highFST <- chrom[chrom$Fst.==max(chrom$Fst.),]
text(x = as.numeric(rownames(highFST)),y = highFST$Fst.,labels = highFST$pos)
chrom$Chr=droplevels(chrom$Chr)
for(i in levels(chrom$Chr)){
tmp_chrom <- chrom[chrom$Chr==i,]
abline(v=min(as.numeric(rownames(tmp_chrom))), col='blue')
}
phi_stat <- read.csv('../../data/populations/d-20_r-75/F/batch_0.phistats_F-M.tsv',header=T,skip=2,sep='\t')
by_chrom <- phi_stat %>% group_by(Chr) %>% summarise(avg=mean(Fst.))
plot(by_chrom,type='p')
chrom <- phi_stat[grep("chr.*", phi_stat$Chr),]
chrom$pos = paste(chrom$Chr,chrom$BP, sep="_")
plot(rownames(chrom), chrom$Fst., type="l")
highFST <- chrom[chrom$Fst.==max(chrom$Fst.),]
text(x = as.numeric(rownames(highFST)),y = highFST$Fst.,labels = highFST$pos)
chrom$Chr=droplevels(chrom$Chr)
for(i in levels(chrom$Chr)){
tmp_chrom <- chrom[chrom$Chr==i,]
abline(v=min(as.numeric(rownames(tmp_chrom))), col='blue')
}
phi_stat <- read.csv('../../data/populations/d-20_r-75/G/batch_0.phistats_F-M.tsv',header=T,skip=2,sep='\t')
by_chrom <- phi_stat %>% group_by(Chr) %>% summarise(avg=mean(Fst.))
plot(by_chrom,type='p')
chrom <- phi_stat[grep("chr.*", phi_stat$Chr),]
chrom$pos = paste(chrom$Chr,chrom$BP, sep="_")
plot(rownames(chrom), chrom$Fst., type="l")
highFST <- chrom[chrom$Fst.==max(chrom$Fst.),]
text(x = as.numeric(rownames(highFST)),y = highFST$Fst.,labels = highFST$pos)
chrom$Chr=droplevels(chrom$Chr)
for(i in levels(chrom$Chr)){
tmp_chrom <- chrom[chrom$Chr==i,]
abline(v=min(as.numeric(rownames(tmp_chrom))), col='blue')
}
LETTERS()
for(fam in LETTERS
phi_stat <- read.csv('../../data/populations/d-20_r-75/G/batch_0.phistats_F-M.tsv',header=T,skip=2,sep='\t')
by_chrom <- phi_stat %>% group_by(Chr) %>% summarise(avg=mean(Fst.))
plot(by_chrom,type='p')
chrom <- phi_stat[grep("chr.*", phi_stat$Chr),]
chrom$pos = paste(chrom$Chr,chrom$BP, sep="_")
plot(rownames(chrom), chrom$Fst., type="l")
highFST <- chrom[chrom$Fst.==max(chrom$Fst.),]
text(x = as.numeric(rownames(highFST)),y = highFST$Fst.,labels = highFST$pos)
chrom$Chr=droplevels(chrom$Chr)
for(i in levels(chrom$Chr)){
tmp_chrom <- chrom[chrom$Chr==i,]
abline(v=min(as.numeric(rownames(tmp_chrom))), col='blue')
}
LETTERS
LETTERS[1:12]
par(mfrow=c(2,6))
par(mfrow=c(2,6))
for(fam in LETTERS[1:12]){
phi_stat <- read.csv(paste0('../../data/populations/d-20_r-75/',fam,'/batch_0.phistats_F-M.tsv'),header=T,skip=2,sep='\t')
by_chrom <- phi_stat %>% group_by(Chr) %>% summarise(avg=mean(Fst.))
plot(by_chrom,type='p')
chrom <- phi_stat[grep("chr.*", phi_stat$Chr),]
chrom$pos = paste(chrom$Chr,chrom$BP, sep="_")
plot(rownames(chrom), chrom$Fst., type="l")
highFST <- chrom[chrom$Fst.==max(chrom$Fst.),]
text(x = as.numeric(rownames(highFST)),y = highFST$Fst.,labels = highFST$pos)
chrom$Chr=droplevels(chrom$Chr)
for(i in levels(chrom$Chr)){
tmp_chrom <- chrom[chrom$Chr==i,]
abline(v=min(as.numeric(rownames(tmp_chrom))), col='blue')
}
}
par(mfrow=c(2,6))
for(fam in LETTERS[1:12]){
phi_stat <- read.csv(paste0('../../data/populations/d-20_r-75/',fam,'/batch_0.phistats_F-M.tsv'),header=T,skip=2,sep='\t')
by_chrom <- phi_stat %>% group_by(Chr) %>% summarise(avg=mean(Fst.))
plot(by_chrom,type='p')
chrom <- phi_stat[grep("chr.*", phi_stat$Chr),]
chrom$pos = paste(chrom$Chr,chrom$BP, sep="_")
#plot(rownames(chrom), chrom$Fst., type="l")
highFST <- chrom[chrom$Fst.==max(chrom$Fst.),]
text(x = as.numeric(rownames(highFST)),y = highFST$Fst.,labels = highFST$pos)
chrom$Chr=droplevels(chrom$Chr)
for(i in levels(chrom$Chr)){
tmp_chrom <- chrom[chrom$Chr==i,]
abline(v=min(as.numeric(rownames(tmp_chrom))), col='blue')
}
}
par(mfrow=c(2,6))
for(fam in LETTERS[1:12]){
phi_stat <- read.csv(paste0('../../data/populations/d-20_r-75/',fam,'/batch_0.phistats_F-M.tsv'),header=T,skip=2,sep='\t')
by_chrom <- phi_stat %>% group_by(Chr) %>% summarise(avg=mean(Fst.))
#plot(by_chrom,type='p')
chrom <- phi_stat[grep("chr.*", phi_stat$Chr),]
chrom$pos = paste(chrom$Chr,chrom$BP, sep="_")
#plot(rownames(chrom), chrom$Fst., type="l")
highFST <- chrom[chrom$Fst.==max(chrom$Fst.),]
text(x = as.numeric(rownames(highFST)),y = highFST$Fst.,labels = highFST$pos)
chrom$Chr=droplevels(chrom$Chr)
for(i in levels(chrom$Chr)){
tmp_chrom <- chrom[chrom$Chr==i,]
abline(v=min(as.numeric(rownames(tmp_chrom))), col='blue')
}
}
par(mfrow=c(2,6))
for(fam in LETTERS[1:12]){
phi_stat <- read.csv(paste0('../../data/populations/d-20_r-75/',fam,'/batch_0.phistats_F-M.tsv'),header=T,skip=2,sep='\t')
by_chrom <- phi_stat %>% group_by(Chr) %>% summarise(avg=mean(Fst.))
#plot(by_chrom,type='p')
chrom <- phi_stat[grep("chr.*", phi_stat$Chr),]
chrom$pos = paste(chrom$Chr,chrom$BP, sep="_")
plot(rownames(chrom), chrom$Fst., type="l")
highFST <- chrom[chrom$Fst.==max(chrom$Fst.),]
text(x = as.numeric(rownames(highFST)),y = highFST$Fst.,labels = highFST$pos)
chrom$Chr=droplevels(chrom$Chr)
for(i in levels(chrom$Chr)){
tmp_chrom <- chrom[chrom$Chr==i,]
abline(v=min(as.numeric(rownames(tmp_chrom))), col='blue')
}
}
in_path <- '../../data/populations/d-20_r-75/'
in_path <- '../../data/populations/d-20_r-75/'
list.dirs(in_path)
list.dirs(in_path,full.names = F)
list.dirs(in_path)[2:length(list.dirs(in_path))]
tmp_phi <- read_delim(paste0(fam,'/batch_0.phistats_F-M.tsv'),col_names=T,skip=2,delim='\t')
fam = list.dirs(in_path)[2:length(list.dirs(in_path))][3]
fam
tmp_phi <- read_delim(paste0(fam,'/batch_0.phistats_F-M.tsv'),col_names=T,skip=2,delim='\t')
tmp_phi <- read_delim(paste0(fam,'/batch_0.phistats_F-M.tsv'),col_names=T,skip=2,delim='\t',progress = F)
phi_stat <- data.frame()
phi_stat <- rbind(phi_stat, tmp_phi)
phi_stat
phi_stat <- data.frame()
for(fam in list.dirs(in_path)[2:length(list.dirs(in_path))]){  # Excluding first dir (parent)
tmp_phi <- read.csv(paste0(fam,'/batch_0.phistats_F-M.tsv'),header=T,skip=2,sep='\t')
phi_stat <- rbind(phi_stat, tmp_phi)
}
View(phi_stat)
by_chrom <- phi_stat %>% group_by(Chr) %>% summarise(avg=mean(Fst.))
plot(by_chrom,type='p')
chrom <- phi_stat[grep("chr.*", phi_stat$Chr),]
chrom$pos = paste(chrom$Chr,chrom$BP, sep="_")
plot(rownames(chrom), chrom$Fst., type="l", ylab='Fst')
plot(rownames(chrom), chrom$Fst., type="l", ylab='Fst')
highFST <- chrom[chrom$Fst.==max(chrom$Fst.),]
text(x = as.numeric(rownames(highFST)),y = highFST$Fst.,labels = highFST$pos)
chrom$Chr=droplevels(chrom$Chr)
for(i in levels(chrom$Chr)){
tmp_chrom <- chrom[chrom$Chr==i,]
abline(v=min(as.numeric(rownames(tmp_chrom))), col='blue')
}
chrom$Chr
fam
basename(fam)
tmp_phi$fam <- rep(basename(fam))
phi_stat <- data.frame()
for(fam in list.dirs(in_path)[2:length(list.dirs(in_path))]){  # Excluding first dir (parent)
tmp_phi <- read.csv(paste0(fam,'/batch_0.phistats_F-M.tsv'),header=T,skip=2,sep='\t')
tmp_phi$fam <- rep(basename(fam))
phi_stat <- rbind(phi_stat, tmp_phi)
}
View(phi_stat)
by_chrom <- phi_stat %>% group_by(Chr) %>% summarise(avg=mean(Fst.))
plot(by_chrom,type='p')
View(chrom)
View(by_chrom)
View(tmp_phi)
View(tmp_phi)
View(phi_stat)
phi_stat %<>% arrange(Chr, BP)
library(dplyr)
by_chrom <- phi_stat %>% group_by(Chr) %>% summarise(avg=mean(Fst.))
phi_stat %<>% arrange(Chr, BP)
phi_stat %>% arrange(Chr, BP)
library(tidyverse)
phi_stat %<>% arrange(Chr, BP)
phi_stat <- phi_stat %>% arrange(Chr, BP)
chrom <- phi_stat[grep("chr.*", phi_stat$Chr),]
chrom$pos = paste(chrom$Chr,chrom$BP, sep="_")
plot(rownames(chrom), chrom$Fst., type="l", ylab='Fst')
highFST <- chrom[chrom$Fst.==max(chrom$Fst.),]
text(x = as.numeric(rownames(highFST)),y = highFST$Fst.,labels = highFST$pos)
chrom$Chr=droplevels(chrom$Chr)
for(i in levels(chrom$Chr)){
tmp_chrom <- chrom[chrom$Chr==i,]
abline(v=min(as.numeric(rownames(tmp_chrom))), col='blue')
}
View(phi_stat)
indv <- read.table("../../data/haploid_males")
indv
haplo <- read.table("../../data/haploid_males")
View(haplo)
indv <- read.table("../../individuals")
indv <- read.table("../../data/individuals")
View(indv)
indv <- read.table("../../data/individuals", header=T)
View(indv)
mothers <- indv[indv$Generation=="F3",]
View(mothers)
View(phi_stat)
levels(mothers$Family)
find(unite)
find("unite")
