for(chrom in levels(chrom_stat$Chr)){
chr_models[[chrom]] <- loess(data=chrom_stat[chrom_stat$Chr==chrom,],
formula=hom~BP, weights=weight, span=300, model=T)
}
chr_models <- list()
for(chrom in levels(chrom_stat$Chr)){
chr_models[[chrom]] <- loess(data=chrom_stat[chrom_stat$Chr==chrom,],
formula=hom~BP, weights=weight, span=300, model=T)
}
plot(chr_models$chr2$fitted)
plot(chr_models$chr2$x,chr_models$chr2$fitted)
par(mfrow=c(1,6))
for(mod in chr_models){
plot(chr_models[[mod]]$x,chr_models[[mod]]$fitted)
}
plot(chr_models[mod]$x,chr_models[mod]$fitted)
plot(chr_models$mod$x,chr_models$mod$fitted)
par(mfrow=c(1,6))
for(mod in chr_models){
plot(mod$x,mod$fitted)
}
par(mfrow=c(6,1))
for(mod in chr_models){
plot(mod$x,mod$fitted)
}
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x,mod$fitted)
}
chr_models <- list()
for(chrom in levels(chrom_stat$Chr)){
chr_models[[chrom]] <- loess(data=chrom_stat[chrom_stat$Chr==chrom,],
formula=hom~BP, weights=weight, span=30, model=T)
}
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x,mod$fitted)
}
mod
mod$residuals
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x,mod$fitted)
points(mod$x,mod$residuals,type='l',col='grey',lty=2)
points(mod$x,-mod$residuals,type='l',col='grey',lty=2)
}
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x,mod$fitted)
points(mod$x,mod$fitted + mod$residuals,type='l',col='grey',lty=2)
points(mod$x,mod$fitted - mod$residuals,type='l',col='grey',lty=2)
}
mod$fitted - mod$residuals
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x,mod$fitted)
points(mod$x,(mod$fitted + mod$residuals),type='l',col='grey',lty=2)
points(mod$x,(mod$fitted - mod$residuals),type='l',col='grey',lty=2)
}
mod$fitted - mod$residuals
points(mod$x,(mod$fitted + mod$residuals^2),type='l',col='grey',lty=2)
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x,mod$fitted)
points(mod$x,(mod$fitted + mod$residuals^2),type='l',col='grey',lty=2)
points(mod$x,(mod$fitted - mod$residuals^2),type='l',col='grey',lty=2)
}
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x,mod$fitted)
points(mod$x,(mod$fitted + mod$residuals^2),type='l',col='blue',lty=2)
points(mod$x,(mod$fitted - mod$residuals^2),type='l',col='red',lty=2)
}
points(mod$x,(mod$fitted - mod$residuals^2),type='p')
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x,mod$fitted)
points(mod$x,(mod$fitted + mod$residuals^2),type='l',col='blue',lty=2)
points(mod$x,(mod$fitted - mod$residuals^2),type='p')
}
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x,mod$fitted)
points(mod$x,(mod$fitted + mod$residuals),type='p'col='blue')
points(mod$x,(mod$fitted - mod$residuals),type='p', col='red')
}
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x,mod$fitted)
points(mod$x,(mod$fitted + mod$residuals),type='p',col='blue')
points(mod$x,(mod$fitted - mod$residuals),type='p', col='red')
}
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x,mod$fitted)
points(mod$x,(mod$fitted + mod$residuals^2),type='p',col='blue')
points(mod$x,(mod$fitted - mod$residuals^2),type='p', col='red')
}
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x[mod$fitted==min(mod$fitted)],1)
abline(h=1)
}
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x[mod$fitted==min(mod$fitted)],rep(1))
abline(h=1)
}
plot(mod$x[mod$fitted==min(mod$fitted)],rep(1,length(mod$x[mod$fitted==min(mod$fitted)])))
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x[mod$fitted==min(mod$fitted)],rep(1,length(mod$x[mod$fitted==min(mod$fitted)])))
abline(h=1)
}
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x[mod$fitted==min(mod$fitted)],rep(1,length(mod$x[mod$fitted==min(mod$fitted)])),
xlim=c(min(mod$x),max(mod$x)))
abline(h=1)
}
ggplot(chrom_stat, aes(x=BP, y=hom, weight=weight)) + facet_grid(~Chr, scales='free_x') +
geom_point(col='grey70') + stat_smooth(fill='steelblue', method='loess', fullrange = F, span=0.4)
chr_models <- list()
for(chrom in levels(chrom_stat$Chr)){
chr_models[[chrom]] <- loess(data=chrom_stat[chrom_stat$Chr==chrom,],
formula=hom~BP, weights=weight, span=0.4, model=T)
}
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x[mod$fitted==min(mod$fitted)],rep(1,length(mod$x[mod$fitted==min(mod$fitted)])),
xlim=c(min(mod$x),max(mod$x)))
abline(h=1)
}
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x,mod$fitted)
points(mod$x,(mod$fitted + mod$residuals^2),type='p',col='blue')
points(mod$x,(mod$fitted - mod$residuals^2),type='p', col='red')
}
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x,mod$fitted)
#points(mod$x,(mod$fitted + mod$residuals^2),type='p',col='blue')
#points(mod$x,(mod$fitted - mod$residuals^2),type='p', col='red')
}
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x,mod$fitted, ylim=c(-0.1,1))
#points(mod$x,(mod$fitted + mod$residuals^2),type='p',col='blue')
#points(mod$x,(mod$fitted - mod$residuals^2),type='p', col='red')
}
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x,mod$fitted, ylim=c(-0.05,1))
#points(mod$x,(mod$fitted + mod$residuals^2),type='p',col='blue')
#points(mod$x,(mod$fitted - mod$residuals^2),type='p', col='red')
}
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x,mod$fitted, ylim=c(-0.05,1), type='l')
#points(mod$x,(mod$fitted + mod$residuals^2),type='p',col='blue')
#points(mod$x,(mod$fitted - mod$residuals^2),type='p', col='red')
}
plot(mod$x,mod$fitted, ylim=c(-0.05,1))
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x,mod$fitted, ylim=c(-0.05,1))
points(mod$x[mod$fitted==min(mod$fitted)],rep(-0.01,length(mod$x[mod$fitted==min(mod$fitted)])),
xlim=c(min(mod$x),max(mod$x)))
abline(h=-0.01)
}
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x,mod$fitted, ylim=c(-0.05,1))
points(mod$x[mod$fitted==min(mod$fitted)],rep(-0.01,length(mod$x[mod$fitted==min(mod$fitted)])),
xlim=c(min(mod$x),max(mod$x)), col='red')
abline(h=-0.01)
}
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x,mod$fitted, ylim=c(-0.05,1), type='b')
points(mod$x[mod$fitted==min(mod$fitted)],rep(-0.01,length(mod$x[mod$fitted==min(mod$fitted)])),
xlim=c(min(mod$x),max(mod$x)), col='red')
abline(h=-0.01)
}
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x,mod$fitted[order(mod$x)], ylim=c(-0.05,1), type='b')
points(mod$x[mod$fitted==min(mod$fitted)],rep(-0.01,length(mod$x[mod$fitted==min(mod$fitted)])),
xlim=c(min(mod$x),max(mod$x)), col='red')
abline(h=-0.01)
}
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x[order(x)],mod$fitted[order(x)], ylim=c(-0.05,1), type='b')
points(mod$x[mod$fitted==min(mod$fitted)],rep(-0.01,length(mod$x[mod$fitted==min(mod$fitted)])),
xlim=c(min(mod$x),max(mod$x)), col='red')
abline(h=-0.01)
}
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x[order(mod$x)],mod$fitted[order(mod$x)], ylim=c(-0.05,1), type='b')
points(mod$x[mod$fitted==min(mod$fitted)],rep(-0.01,length(mod$x[mod$fitted==min(mod$fitted)])),
xlim=c(min(mod$x),max(mod$x)), col='red')
abline(h=-0.01)
}
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x[order(mod$x)],mod$fitted[order(mod$x)], ylim=c(-0.05,1), type='l')
points(mod$x[mod$fitted==min(mod$fitted)],rep(-0.01,length(mod$x[mod$fitted==min(mod$fitted)])),
xlim=c(min(mod$x),max(mod$x)), col='red')
abline(h=-0.01)
}
chr_models <- list()
for(chrom in levels(chrom_stat$Chr)){
chr_models[[chrom]] <- loess(data=chrom_stat[chrom_stat$Chr==chrom,],
formula=hom~BP, weights=weight, span=0.8, model=T)
}
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x[order(mod$x)],mod$fitted[order(mod$x)], ylim=c(-0.05,1), type='l')
points(mod$x[mod$fitted==min(mod$fitted)],rep(-0.01,length(mod$x[mod$fitted==min(mod$fitted)])),
xlim=c(min(mod$x),max(mod$x)), col='red')
abline(h=-0.01)
}
chr_models <- list()
for(chrom in levels(chrom_stat$Chr)){
chr_models[[chrom]] <- loess(data=chrom_stat[chrom_stat$Chr==chrom,],
formula=hom~BP, weights=weight, span=5, model=T)
}
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x[order(mod$x)],mod$fitted[order(mod$x)], ylim=c(-0.05,1), type='l')
points(mod$x[mod$fitted==min(mod$fitted)],rep(-0.01,length(mod$x[mod$fitted==min(mod$fitted)])),
xlim=c(min(mod$x),max(mod$x)), col='red')
abline(h=-0.01)
}
chr_models <- list()
for(chrom in levels(chrom_stat$Chr)){
chr_models[[chrom]] <- loess(data=chrom_stat[chrom_stat$Chr==chrom,],
formula=hom~BP, weights=weight, span=1, model=T)
}
par(mfrow=c(3,2))
for(mod in chr_models){
plot(mod$x[order(mod$x)],mod$fitted[order(mod$x)], ylim=c(-0.05,1), type='l')
points(mod$x[mod$fitted==min(mod$fitted)],rep(-0.01,length(mod$x[mod$fitted==min(mod$fitted)])),
xlim=c(min(mod$x),max(mod$x)), col='red')
abline(h=-0.01)
}
par(mfrow=c(3,2))
for(chrom in levels(chrom_stat$Chr)){
plot(xlim=c(0,max(chrom_stat$BP[chrom_stat$Chr==chrom])), ylim=c(-0.05,1))
abline(h=-0.01)
for(sp in c(1,2,3)){
tmp_mod <- loess(data=chrom_stat[chrom_stat$Chr==chrom,],
formula=hom~BP, weights=weight, span=1, model=T)
points(mod$x[order(mod$x)],mod$fitted[order(mod$x)], type='l')
points(mod$x[mod$fitted==min(mod$fitted)],rep(-0.01,length(mod$x[mod$fitted==min(mod$fitted)])),
col='red')
}
}
plot(x=c(),y=c()xlim=c(0,max(chrom_stat$BP[chrom_stat$Chr==chrom])), ylim=c(-0.05,1))
par(mfrow=c(3,2))
for(chrom in levels(chrom_stat$Chr)){
plot(x=c(),y=c(),xlim=c(0,max(chrom_stat$BP[chrom_stat$Chr==chrom])), ylim=c(-0.05,1))
abline(h=-0.01)
for(sp in c(1,2,3)){
tmp_mod <- loess(data=chrom_stat[chrom_stat$Chr==chrom,],
formula=hom~BP, weights=weight, span=1, model=T)
points(mod$x[order(mod$x)],mod$fitted[order(mod$x)], type='l')
points(mod$x[mod$fitted==min(mod$fitted)],rep(-0.01,length(mod$x[mod$fitted==min(mod$fitted)])),
col='red')
}
}
par(mfrow=c(3,2))
for(chrom in levels(chrom_stat$Chr)){
plot(x=c(),y=c(),xlim=c(0,max(chrom_stat$BP[chrom_stat$Chr==chrom])), ylim=c(-0.05,1))
abline(h=-0.01)
for(sp in c(1,2,3)){
mod <- loess(data=chrom_stat[chrom_stat$Chr==chrom,],
formula=hom~BP, weights=weight, span=1, model=T)
points(mod$x[order(mod$x)],mod$fitted[order(mod$x)], type='l')
points(mod$x[mod$fitted==min(mod$fitted)],rep(-0.01,length(mod$x[mod$fitted==min(mod$fitted)])),
col='red')
}
}
par(mfrow=c(3,2))
for(chrom in levels(chrom_stat$Chr)){
plot(x=c(),y=c(),xlim=c(0,max(chrom_stat$BP[chrom_stat$Chr==chrom])), ylim=c(-0.05,1))
abline(h=-0.01)
for(sp in c(1,2,3)){
mod <- loess(data=chrom_stat[chrom_stat$Chr==chrom,],
formula=hom~BP, weights=weight, span=sp, model=T)
points(mod$x[order(mod$x)],mod$fitted[order(mod$x)], type='l')
points(mod$x[mod$fitted==min(mod$fitted)],rep(-0.01,length(mod$x[mod$fitted==min(mod$fitted)])),
col='red')
}
}
par(mfrow=c(3,2))
for(chrom in levels(chrom_stat$Chr)){
plot(x=c(),y=c(),xlim=c(0,max(chrom_stat$BP[chrom_stat$Chr==chrom])), ylim=c(-0.05,1))
abline(h=-0.01)
for(sp in seq(0.4,4,0.1)){
mod <- loess(data=chrom_stat[chrom_stat$Chr==chrom,],
formula=hom~BP, weights=weight, span=sp, model=T)
points(mod$x[order(mod$x)],mod$fitted[order(mod$x)], type='l')
points(mod$x[mod$fitted==min(mod$fitted)],rep(-0.01,length(mod$x[mod$fitted==min(mod$fitted)])),
col='red')
}
}
library(viridis)
install.packages('viridis')
library(viridis)
viridis
viridis()
viridis(n=1)
viridis(n=2)
sp_range <- seq(0.4,4,0.1)
virilist <- viridis(n=length(sp_range))
library(viridis)
sp_range <- seq(0.4,4,0.1)
virilist <- viridis(n=length(sp_range))
colindex <- 1
par(mfrow=c(3,2))
for(chrom in levels(chrom_stat$Chr)){
plot(x=c(),y=c(),xlim=c(0,max(chrom_stat$BP[chrom_stat$Chr==chrom])), ylim=c(-0.05,1))
abline(h=-0.01)
for(sp in sp_range){
mod <- loess(data=chrom_stat[chrom_stat$Chr==chrom,],
formula=hom~BP, weights=weight, span=sp, model=T)
points(mod$x[order(mod$x)],mod$fitted[order(mod$x)], type='l',col=virilist[colindex])
points(mod$x[mod$fitted==min(mod$fitted)],rep(-0.01,length(mod$x[mod$fitted==min(mod$fitted)])),
col=virilist[colindex])
colindex <- colindex+1
}
}
library(viridis)
sp_range <- seq(0.4,4,0.1)
virilist <- viridis(n=length(sp_range))
colindex <- 1
par(mfrow=c(3,2))
for(chrom in levels(chrom_stat$Chr)){
plot(x=c(),y=c(),xlim=c(0,max(chrom_stat$BP[chrom_stat$Chr==chrom])), ylim=c(-0.05,1))
abline(h=-0.01)
for(sp in sp_range){
mod <- loess(data=chrom_stat[chrom_stat$Chr==chrom,],
formula=hom~BP, weights=weight, span=sp, model=T)
points(mod$x[order(mod$x)],mod$fitted[order(mod$x)], type='l',col=virilist[colindex])
points(mod$x[mod$fitted==min(mod$fitted)],rep(-0.01,length(mod$x[mod$fitted==min(mod$fitted)])),
col=virilist[colindex])
colindex <- colindex+1
}
colindex <- 1
}
library(viridis)
sp_range <- seq(0.4,4,0.1)
virilist <- viridis(n=length(sp_range))
colindex <- 1
par(mfrow=c(3,2))
for(chrom in levels(chrom_stat$Chr)){
plot(x=c(),y=c(),xlim=c(0,max(chrom_stat$BP[chrom_stat$Chr==chrom])), ylim=c(-0.05,1))
abline(h=-0.01)
for(sp in sp_range){
mod <- loess(data=chrom_stat[chrom_stat$Chr==chrom,],
formula=hom~BP, weights=weight, span=sp, model=T)
points(mod$x[order(mod$x)],mod$fitted[order(mod$x)], type='l',col=virilist[colindex], alpha=0.4)
points(mod$x[mod$fitted==min(mod$fitted)],rep(-0.01,length(mod$x[mod$fitted==min(mod$fitted)])),
col=virilist[colindex])
colindex <- colindex+1
}
colindex <- 1
}
warnings()
library(viridis)
sp_range <- seq(0.4,4,0.1)
virilist <- viridis(n=length(sp_range))
colindex <- 1
par(mfrow=c(3,2))
for(chrom in levels(chrom_stat$Chr)){
plot(x=c(),y=c(),xlim=c(0,max(chrom_stat$BP[chrom_stat$Chr==chrom])), ylim=c(-0.05,1))
abline(h=-0.01)
for(sp in sp_range){
mod <- loess(data=chrom_stat[chrom_stat$Chr==chrom,],
formula=hom~BP, weights=weight, span=sp, model=T)
points(mod$x[order(mod$x)],mod$fitted[order(mod$x)], type='l',col=alpha(virilist[colindex],0.4))
points(mod$x[mod$fitted==min(mod$fitted)],rep(-0.01,length(mod$x[mod$fitted==min(mod$fitted)])),
col=alpha(virilist[colindex],0.4))
colindex <- colindex+1
}
colindex <- 1
}
library(viridis)
sp_range <- seq(0.4,4,0.1)
virilist <- viridis(n=length(sp_range))
colindex <- 1
par(mfrow=c(3,2))
for(chrom in levels(chrom_stat$Chr)){
plot(x=c(),y=c(),xlim=c(0,max(chrom_stat$BP[chrom_stat$Chr==chrom])), ylim=c(-0.05,1))
abline(h=-0.01)
for(sp in sp_range){
mod <- loess(data=chrom_stat[chrom_stat$Chr==chrom,],
formula=hom~BP, weights=weight, span=sp, model=T)
points(mod$x[order(mod$x)],mod$fitted[order(mod$x)], type='l',col=alpha(virilist[colindex],0.4))
points(mod$x[mod$fitted==min(mod$fitted)],rep(-0.01,length(mod$x[mod$fitted==min(mod$fitted)])),
col=alpha(virilist[colindex],0.4),pch=16)
colindex <- colindex+1
}
colindex <- 1
}
library(viridis)
sp_range <- seq(0.4,4,0.1)
virilist <- viridis(n=length(sp_range))
colindex <- 1
par(mfrow=c(3,2))
for(chrom in levels(chrom_stat$Chr)){
plot(x=c(),y=c(),xlim=c(0,max(chrom_stat$BP[chrom_stat$Chr==chrom])), ylim=c(-0.05,1))
abline(h=-0.01)
for(sp in sp_range){
mod <- loess(data=chrom_stat[chrom_stat$Chr==chrom,],
formula=hom~BP, weights=weight, span=sp, model=T)
points(mod$x[order(mod$x)],mod$fitted[order(mod$x)], type='l',col=alpha(virilist[colindex],0.4))
points(mod$x[mod$fitted==min(mod$fitted)],rep(-0.01,length(mod$x[mod$fitted==min(mod$fitted)])),
col=alpha(virilist[colindex],0.4),pch=16, size=3)
colindex <- colindex+1
}
colindex <- 1
}
warnings()
library(viridis)
sp_range <- seq(0.4,4,0.1)
virilist <- viridis(n=length(sp_range))
colindex <- 1
par(mfrow=c(3,2))
for(chrom in levels(chrom_stat$Chr)){
plot(x=c(),y=c(),xlim=c(0,max(chrom_stat$BP[chrom_stat$Chr==chrom])), ylim=c(-0.05,1))
abline(h=-0.01)
for(sp in sp_range){
mod <- loess(data=chrom_stat[chrom_stat$Chr==chrom,],
formula=hom~BP, weights=weight, span=sp, model=T)
points(mod$x[order(mod$x)],mod$fitted[order(mod$x)], type='l',col=alpha(virilist[colindex],0.4))
points(mod$x[mod$fitted==min(mod$fitted)],rep(-0.01,length(mod$x[mod$fitted==min(mod$fitted)])),
col=alpha(virilist[colindex],0.4),pch=16, cex=3)
colindex <- colindex+1
}
colindex <- 1
}
library(viridis)
sp_range <- seq(0.4,4,0.1)
virilist <- viridis(n=length(sp_range))
colindex <- 1
par(mfrow=c(3,2))
for(chrom in levels(chrom_stat$Chr)){
plot(x=c(),y=c(),xlim=c(0,max(chrom_stat$BP[chrom_stat$Chr==chrom])), ylim=c(-0.05,1))
abline(h=-0.01)
for(sp in sp_range){
mod <- loess(data=chrom_stat[chrom_stat$Chr==chrom,],
formula=hom~BP, weights=weight, span=sp, model=T)
points(mod$x[order(mod$x)],mod$fitted[order(mod$x)], type='l',col=alpha(virilist[colindex],0.4))
points(mod$x[mod$fitted==min(mod$fitted)],rep(-0.01,length(mod$x[mod$fitted==min(mod$fitted)])),
col=alpha(virilist[colindex],0.4),pch=16, cex=1.5)
colindex <- colindex+1
}
colindex <- 1
}
library(viridis)
sp_range <- seq(0.3,4,0.1)
virilist <- viridis(n=length(sp_range))
colindex <- 1
par(mfrow=c(3,2))
for(chrom in levels(chrom_stat$Chr)){
plot(x=c(),y=c(),xlim=c(0,max(chrom_stat$BP[chrom_stat$Chr==chrom])), ylim=c(-0.05,1))
abline(h=-0.01)
for(sp in sp_range){
mod <- loess(data=chrom_stat[chrom_stat$Chr==chrom,],
formula=hom~BP, weights=weight, span=sp, model=T)
points(mod$x[order(mod$x)],mod$fitted[order(mod$x)], type='l',col=alpha(virilist[colindex],0.4))
points(mod$x[mod$fitted==min(mod$fitted)],rep(-0.01,length(mod$x[mod$fitted==min(mod$fitted)])),
col=alpha(virilist[colindex],0.4),pch=16, cex=1.5)
colindex <- colindex+1
}
colindex <- 1
}
library(dplyr)
indv <- read.table("../../data/ploidy/thresholds/fixed", header=T)
diplo <- indv[indv$Generation=="F4" & indv$Ploidy=='D',]
off_comp <- data.frame(table(diplo$Family, diplo$Sex))
colnames(off_comp) <- c("Family", "Sex", "Count")
off_comp <- off_comp %>%
group_by(Family) %>%
mutate(prop_males=round(Count[Sex=='M']/sum(Count),3)) %>%
filter(Sex=='M') %>%
select(-Sex)
kmeans(off_comp$prop_males)
kmeans(off_comp$prop_males,centers=3)
kmeans(off_comp$prop_males,centers=2)
View(off_comp)
kmeans(off_comp$prop_males,centers=3)
k <- kmeans(off_comp$prop_males,centers=3)
k$cluste
k$cluster
table(k$cluster)
kmeans(off_comp$prop_males,centers=3)$cluster
table(kmeans(off_comp$prop_males,centers=3)$cluster)
table(kmeans(off_comp$prop_males,centers=2)$cluster)
table(kmeans(off_comp$prop_males,centers=4)$cluster)
k$centers
table(kmeans(off_comp$prop_males,centers=4,algorithm = 'jenks')$cluster)
0.25*0.66
0.8*0.66
table(kmeans(off_comp$prop_males,centers=3,algorithm = 'jenks')$cluster)
ggplot(chrom_stat, aes(x=BP, y=hom, weight=weight)) + facet_grid(~Chr, scales='free_x') +
geom_point(col='grey70') + stat_smooth(fill='steelblue', method='loess', fullrange = F, span=0.4)
