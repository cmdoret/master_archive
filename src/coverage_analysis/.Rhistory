ggplot(data=fixed, aes(x=MEAN_DEPTH))+geom_histogram()
fixed <- read.table("../../../data/ploidy/thresholds/fixed",header=T)
ggplot(data=fixed, aes(x=MEAN_DEPTH))+geom_histogram()
library(ggplot2)
ggplot(data=fixed, aes(x=MEAN_DEPTH))+geom_histogram()
ggplot(data=fixed, aes(x=MEAN_DEPTH,fill=Family))+geom_histogram()
fixed$Family <- as.character(fixed$Family)
fam_sites <- fixed %>%
select(Family,N_SITES) %>%
group_by(Family) %>%
summarise(avg=mean(N_SITES))
fixed$Family <- factor(fixed$Family,levels = fam_sites$Family[order(fam_depth$avg)],ordered = T)
ggplot(data=fixed,aes(x=N_SITES,y=Family))+geom_joy2(col = "grey10", fill = "grey70")+ggtitle("Number of sites per sample, by family (all samples)") + theme_minimal()
library(ggplot2);library(ggjoy)
fixed <- read.table("../../../data/ploidy/thresholds/fixed",header=T)
fixed$Family <- as.character(fixed$Family)
fam_sites <- fixed %>%
select(Family,N_SITES) %>%
group_by(Family) %>%
summarise(avg=mean(N_SITES))
fixed$Family <- factor(fixed$Family,levels = fam_sites$Family[order(fam_depth$avg)],ordered = T)
ggplot(data=fixed,aes(x=N_SITES,y=Family))+geom_joy2(col = "grey10", fill = "grey70")+ggtitle("Number of sites per sample, by family (all samples)") + theme_minimal()
fixed$Family <- factor(fixed$Family,levels = fam_sites$Family[order(fam_sites$avg)],ordered = T)
ggplot(data=fixed,aes(x=N_SITES,y=Family))+geom_joy2(col = "grey10", fill = "grey70")+ggtitle("Number of sites per sample, by family (all samples)") + theme_minimal()
fam_sites <- fixed %>%
select(Family,N_SITES) %>%
group_by(Family) %>%
summarise(avg=mean(N_SITES))
library(ggplot2);library(ggjoy);library(tidyr)
fixed <- read.table("../../../data/ploidy/thresholds/fixed",header=T)
fixed$Family <- as.character(fixed$Family)
fam_sites <- fixed %>%
select(Family,N_SITES) %>%
group_by(Family) %>%
summarise(avg=mean(N_SITES))
library(ggplot2);library(ggjoy);library(dplyr)
fixed <- read.table("../../../data/ploidy/thresholds/fixed",header=T)
fixed$Family <- as.character(fixed$Family)
fam_sites <- fixed %>%
select(Family,N_SITES) %>%
group_by(Family) %>%
summarise(avg=mean(N_SITES))
fixed$Family <- factor(fixed$Family,levels = fam_sites$Family[order(fam_sites$avg)],ordered = T)
ggplot(data=fixed,aes(x=N_SITES,y=Family))+geom_joy2(col = "grey10", fill = "grey70")+ggtitle("Number of sites per sample, by family (all samples)") + theme_minimal()
fam_sites <- fixed %>%
select(Family,MEAN_DEPTH) %>%
group_by(Family) %>%
summarise(avg=mean(MEAN_DEPTH))
fixed$Family <- factor(fixed$Family,levels = fam_depth$Family[order(fam_depth$avg)],ordered = T)
fam_depth <- fixed %>%
select(Family,MEAN_DEPTH) %>%
group_by(Family) %>%
summarise(avg=mean(MEAN_DEPTH))
fixed$Family <- factor(fixed$Family,levels = fam_depth$Family[order(fam_depth$avg)],ordered = T)
ggplot(data=fixed, aes(x=MEAN_DEPTH,fill=Family))+geom_histogram()
ggplot(data=fixed, aes(x=N_SITES, y=MEAN_DEPTH,col=Ploidy))+geom_point()+facet_wrap(~Family)
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family))+geom_joy2(col = "grey10", fill = "grey70")+ggtitle("Mean depth per sample, by family (all samples)") + theme_minimal()
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family))+geom_joy2(col = "grey10", fill = fam_depth$avg)+ggtitle("Mean depth per sample, by family (all samples)") + theme_minimal()
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family))+geom_joy2(col = "grey10", fill = "grey70")+ggtitle("Mean depth per sample, by family (all samples)") + theme_minimal()
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family, heaight=..count..))+geom_joy2(stat='binline',draw_baseline=F,col = "grey10", fill = "grey70")+ggtitle("Mean depth per sample, by family (all samples)") + theme_minimal()
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family, heaight=..count..))+geom_joy2(stat='binline',draw_baseline=F,col = Sex, fill = "grey70")+ggtitle("Mean depth per sample, by family (all samples)") + theme_minimal()
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family, heaight=..count..))+geom_joy2(stat='binline',draw_baseline=F, fill = Sex)+ggtitle("Mean depth per sample, by family (all samples)") + theme_minimal()
fixed
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family, heaight=..count..))+geom_joy2(stat='binline',draw_baseline=F, fill = fixed$Sex)+ggtitle("Mean depth per sample, by family (all samples)") + theme_minimal()
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family, heaight=..count.., fill=Sex))+geom_joy2(stat='binline',draw_baseline=F)+ggtitle("Mean depth per sample, by family (all samples)") + theme_minimal()
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family, heaight=..count.., fill=Sex))+geom_joy2(stat='binline')+ggtitle("Mean depth per sample, by family (all samples)") + theme_minimal()
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family, heaight=..count.., fill=Family))+geom_joy2(stat='binline')+ggtitle("Mean depth per sample, by family (all samples)") + theme_minimal()
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family, heaight=..density.., fill=Family))+geom_joy2(stat='binline')+ggtitle("Mean depth per sample, by family (all samples)") + theme_minimal()
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family, heaight=..count.., fill=Family))+geom_joy2(stat='binline')+ggtitle("Mean depth per sample, by family (all samples)") + theme_minimal()
fixed %>% group_by(Family) %>% mutate(avg=mean(MEAN_DEPTH))
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family, height=..count.., fill=avg_depth))+geom_joy2(stat='binline')+ggtitle("Mean depth per sample, by family (all samples)") + theme_minimal()
fixed <- fixed %>%
group_by(Family) %>%
mutate(avg_depth=mean(MEAN_DEPTH))
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family, height=..count.., fill=avg_depth))+geom_joy2(stat='binline')+ggtitle("Mean depth per sample, by family (all samples)") + theme_minimal()
library(viridis)
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family, height=..count.., fill=avg_depth))+geom_joy2(stat='binline')+ggtitle("Mean depth per sample, by family (all samples)") + theme_minimal() + scale_fill_brewer(palette='viridis)
ggplot(data=fixed, aes(x=N_SITES, y=MEAN_DEPTH,col=Ploidy))+geom_point()+facet_wrap(~Family) +
ggtitle("Coverage versus number of sites per individual (all samples)")
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family, height=..count.., fill=avg_depth))+geom_joy2(stat='binline')+ggtitle("Mean depth per sample, by family (all samples)") + theme_minimal() + scale_fill_brewer(palette='viridis')
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family, height=..count.., fill=avg_depth))+geom_joy2(stat='binline')+ggtitle("Mean depth per sample, by family (all samples)") + theme_minimal() + scale_fill_brewer(palette='viridis')
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family, height=..count.., fill=avg_depth))+geom_joy2(stat='binline')+ggtitle("Mean depth per sample, by family (all samples)") + theme_minimal() + scale_fill_viridis())
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family, height=..count.., fill=avg_depth))+geom_joy2(stat='binline')+ggtitle("Mean depth per sample, by family (all samples)") + theme_minimal() + scale_fill_viridis()
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family, height=..count.., fill=avg_depth))+geom_joy2(stat='binline',alpha=0.3)+ggtitle("Mean depth per sample, by family (all samples)") + theme_minimal() + scale_fill_viridis()
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family, height=..count.., fill=avg_depth))+geom_joy2(stat='binline',alpha=0.34
ggplot(data=fixed, aes(x=N_SITES, y=MEAN_DEPTH,col=Ploidy))+geom_point()+facet_wrap(~Family) +
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family, height=..count.., fill=avg_depth))+geom_joy2(stat='binline',alpha=0.4)+ggtitle("Mean depth per sample, by family (all samples)") + theme_minimal() + scale_fill_viridis()
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family, height=..density.., fill=avg_depth))+geom_joy2(stat='binline',alpha=0.4)+ggtitle("Mean depth per sample, by family (all samples)") + theme_minimal() + scale_fill_viridis()
pdf("cov_per_sample.pdf")
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family, height=..density.., fill=avg_depth))+geom_joy2(stat='binline',alpha=0.4)+ggtitle("Mean sample depth by family (all samples)") + theme_minimal() + scale_fill_viridis()
dev.off()
fixed$MEAN_DEPTH
hist(fixed$MEAN_DEPTH)
mean(fixed$MEAN_DEPTH)
sd(fixed$MEAN_DEPTH)
sort(fixed$MEAN_DEPTH)
View(fixed)
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family, height=..density.., fill=Ploidy))+geom_joy2(stat='binline',alpha=0.4)+ggtitle("Mean sample depth by family (all samples)") + theme_minimal() + scale_fill_viridis()
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family, height=..density.., fill=Ploidy))+geom_joy2(stat='binline',alpha=0.4)+ggtitle("Mean sample depth by family (all samples)") + theme_minimal()
ggplot(data=fixed,aes(x=MEAN_DEPTH,y=Family, height=..density.., fill=Sex))+geom_joy2(stat='binline',alpha=0.4)+ggtitle("Mean sample depth by family (all samples)") + theme_minimal()
library(ggplot2)
library(dplyr)
library(tidyr)
depth <- read.table("../../data/coverage/site_depth.txt", header=T)  # Loading data
depth <- depth[grep("chr*",depth$CHROM),]
depth$CHROM <- droplevels(depth$CHROM)
depth$POS <- round(depth$POS, digits=-3)
depth <- depth %>%
group_by(CHROM, POS, Family) %>%
mutate(avg=mean(MEAN_DEPTH)) %>%
select(-MEAN_DEPTH) %>%
rename(MEAN_DEPTH=avg)
depth <- subset(depth, !duplicated(subset(
depth, select=c(CHROM, POS, Family))))
sp_depth <- spread(depth,Family,MEAN_DEPTH)
sp_depth <- sp_depth[rowSums(!is.na(sp_depth[,3:14]))>0,]
sp_depth <- spread(depth,Family,MEAN_DEPTH)
depth <- subset(depth, !duplicated(subset(
depth, select=c(CHROM, POS, Family))))
depth <- depth %>%
group_by(CHROM, POS, Family) %>%
mutate(avg=mean(MEAN_DEPTH)) %>%
select(-MEAN_DEPTH) %>%
rename(MEAN_DEPTH=avg)
depth <- read.table("../../data/coverage/site_depth.txt", header=T)  # Loading data
setwd(dir = "../../../src/coverage_analysis/")
depth <- read.table("../../data/coverage/site_depth.txt", header=T)  # Loading data
depth <- depth[grep("chr*",depth$CHROM),]
depth$CHROM <- droplevels(depth$CHROM)
depth$POS <- round(depth$POS, digits=-3)
depth <- depth %>%
group_by(CHROM, POS, Family) %>%
mutate(avg=mean(MEAN_DEPTH)) %>%
select(-MEAN_DEPTH) %>%
rename(MEAN_DEPTH=avg)
depth <- subset(depth, !duplicated(subset(
depth, select=c(CHROM, POS, Family))))
sp_depth <- spread(depth,Family,MEAN_DEPTH)
sp_depth <- sp_depth[rowSums(!is.na(sp_depth[,3:14]))>0,]
ggplot(data=depth,aes(x=POS,y=MEAN_DEPTH,col=Family)) +
facet_grid(CHROM~., scales = 'free_x') + geom_point(size=0.3) +
geom_line(alpha=0.4) + theme_bw() + ggtitle("Coverage across genome, 1kb windows") +
xlab("Genomic position of SNP") + ylab("Mean coverage")
