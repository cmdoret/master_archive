ggplot(data=fixed, aes(x=MEAN_DEPTH, y=N_SITES))+geom_point()+ggtitle("Coverage versus number of sites per individual (all samples)")
library(ggplot2)
library(ggplot2)
fixed <- read.table("../../../data/ploidy/thresholds/fixed",header=T)
ggplot(data=fixed,aes(x=N_SITES,fill=Family))+geom_histogram(binwidth = 10)+ggtitle("Number of sites per sample, by family (all samples)")
ggplot(data=fixed,aes(x=N_SITES,fill=Ploidy))+geom_histogram(binwidth = 10)+ggtitle("Number of sites per sample, by ploidy (all samples)")
ggplot(data=fixed, aes(x=MEAN_DEPTH))+geom_histogram()
ggplot(data=fixed, aes(x=MEAN_DEPTH, y=N_SITES))+geom_point()+ggtitle("Coverage versus number of sites per individual (all samples)")
ggplot(data=fixed, aes(x=N_SITES, y=MEAN_DEPTH))+geom_point()+ggtitle("Coverage versus number of sites per individual (all samples)")
ggplot(data=fixed, aes(x=N_SITES, y=MEAN_DEPTH,col=ploidy))+geom_point()+facet_wrap(~Family)
ggplot(data=fixed, aes(x=N_SITES, y=MEAN_DEPTH,col=Ploidy))+geom_point()+facet_wrap(~Family)
install.packages("vcfR")
library(vcfR)
read.vcfR("../../data/populations/d-20_r-80/A/batch_0.vcf")
test_fam <- read.vcfR("../../data/populations/d-20_r-80/A/batch_0.vcf")
test_fam
test_fam@meta
test_fam@fix
test_fam@gt
str(test_fam@gt)
View(test_fam@gt)
View(test_fam@fixed)
View(test_fam@fix)
chrom_test <- create.chromR(vcf=test_fam)
plot(chrom_test)
dna <- ape::read.dna(dna_file, format = "../../data/ref_genome/ordered_genome/merged.fasta")
dna <- ape::read.dna(dna_file="../../data/ref_genome/ordered_genome/merged.fasta")
dna <- ape::read.dna("../../data/ref_genome/ordered_genome/merged.fasta")
chrom_test <- create.chromR(vcf=test_fam, dna=".")
chrom_test <- create.chromR(vcf=test_fam, dna=dna)
plot(chrom_test)
chromoqc(chrom, dp.alpha=20)
chromoqc(chrom_test, dp.alpha=20)
chrom_test@names
chrom_test@len
chrom_test@vcf
test_fam <- read.vcfR("../../data/populations/d-20_r-80/A/batch_0.vcf")
dna <- ape::read.dna("../../data/ref_genome/ordered_genome/merged.fasta")
dna <- ape::read.dna("../../data/ref_genome/ordered_genome/merged.fasta", format='fasta')
chrom_test <- create.chromR(vcf=test_fam, dna=dna)
chrom_test <- create.chromR(vcf=test_fam, seq = dna)
chrom_test@names
chrom_test@len
chrom_test@window_size
chrom_test@seq
chrom_test@seq["chr1"]
chrom_test@seq["chr2"]
plot(chrom_test)
chrom_test
head(chrom_test)
test_fam@meta
test_fam@fixed
test_fam@fix
test_fam@gt
head(test_fam@gt)
chrom_test <- create.chromR(vcf=test_fam)
plot(chrom_test)
chrom_test <- create.chromR(name='supercontig',vcf=test_fam)
plot(chrom_test)
dna <- ape::read.dna("../../data/ref_genome/ordered_genome/merged.fasta", format='fasta')
chrom_test <- create.chromR(name='supercontig',vcf=test_fam,seq=dna)
test_fam@meta
test_fam@fix
vcf_field_names(test_fam)
vcfR2chromR(test_fam)
vcfR2chromR(vcf = test_fam)
chrom_test <- create.chromR(seq=dna)
vcfR2chromR(x = chrom_test,vcf = test_fam)
vcfR2chromR(x = "d",vcf = test_fam)
test_fam@fix
View(test_fam@gt)
test_fam <- read.vcfR("../../data/populations/d-20_r-80/A/batch_0.vcf",verbose = T)
chrom_test <- create.chromR(vcf=test_fam,seq=dna)
test_fam <- read.vcfR("../../data/populations/d-20_r-80/A/batch_0.vcf")
dna <- ape::read.dna("../../data/ref_genome/ordered_genome/oneline_merged.fasta", format='fasta')
chrom_test <- create.chromR(vcf=test_fam,seq=dna)
plot(chrom_test)
